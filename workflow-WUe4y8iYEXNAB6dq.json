{
    "updatedAt":  "2025-11-23T03:25:20.000Z",
    "createdAt":  "2025-11-12T02:04:21.451Z",
    "id":  "WUe4y8iYEXNAB6dq",
    "name":  "LinkedIn-4-GmailOutlook-sub-flow-Workshop-OutreachTracking--Augment",
    "description":  null,
    "active":  false,
    "isArchived":  false,
    "nodes":  [
                  {
                      "parameters":  {
                                         "content":  ""
                                     },
                      "type":  "n8n-nodes-base.stickyNote",
                      "position":  [
                                       -1728,
                                       -928
                                   ],
                      "typeVersion":  1,
                      "id":  "8a5aecd4-49eb-4ebf-b7a8-d6e4495b6a59",
                      "name":  "Sticky Note"
                  },
                  {
                      "parameters":  {
                                         "inputSource":  "passthrough"
                                     },
                      "type":  "n8n-nodes-base.executeWorkflowTrigger",
                      "typeVersion":  1.1,
                      "position":  [
                                       -1984,
                                       -560
                                   ],
                      "id":  "05ff243f-92f7-4ab2-905a-b57b5fc82899",
                      "name":  "Execute Workflow Trigger - From Orchestrator"
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// OUTREACH TRACKING - INPUT PROCESSING (FIXED DATA STRUCTURE ACCESS)\n// Processes contact tracking data for outreach email creation\n// FIXED v2.0: Correctly accesses nested contactRecord structure from Contact Tracking Workshop output\n// Contact Tracking outputs: { contactRecord: {...}, outreachData: {...}, processingMetadata: {...} }\n\nconst inputData = $json;\nconsole.log('üîç Outreach Input Debug:');\nconsole.log('   Input keys:', Object.keys(inputData));\nconsole.log('   ContactRecord keys:', inputData.contactRecord ? Object.keys(inputData.contactRecord) : 'No contactRecord');\nconsole.log('   OutreachData keys:', inputData.outreachData ? Object.keys(inputData.outreachData) : 'No outreachData');\n\n// ‚úÖ FIXED v2.0: Extract data from Contact Tracking workflow output structure\n// Contact Tracking outputs a nested structure with contactRecord, outreachData, processingMetadata\nconst contactRecord = inputData.contactRecord || {};\nconst outreachData = inputData.outreachData || {};\nconst processingMetadata = inputData.processingMetadata || {};\n\nconsole.log('üìã Contact Record Structure:');\nconsole.log('   Has companyName:', !!contactRecord.companyName);\nconsole.log('   Has jobTitle:', !!contactRecord.jobTitle);\nconsole.log('   Has recepientEmail:', !!contactRecord.recepientEmail);\nconsole.log('   Has contactName:', !!contactRecord.contactName);\n\n// ‚úÖ FIXED v2.0: Extract job information from contactRecord (not from inputData directly)\nconst jobTitle = contactRecord.jobTitle;\nconst companyName = contactRecord.companyName;\nconst jobLocation = contactRecord.jobLocation || 'Not specified';\nconst jobUrl = contactRecord.jobUrl || '';\nconst jobDescription = contactRecord.jobDescription || '';\n\n// Validate required inputs\nif (!jobTitle || !companyName) {\n  console.error('‚ùå Validation failed:');\n  console.error('   JobTitle:', jobTitle);\n  console.error('   CompanyName:', companyName);\n  console.error('   ContactRecord keys:', Object.keys(contactRecord));\n  console.error('   Full input structure:', JSON.stringify(inputData, null, 2).substring(0, 500));\n  throw new Error('Invalid job data: missing required fields (jobTitle: ' + !!jobTitle + ', companyName: ' + !!companyName + ')');\n}\n\n// ‚úÖ FIXED v3.0: Extract contact information from contactRecord\nconst contactFirstName = contactRecord.contactFirstName || '';\nconst contactLastName = contactRecord.contactLastName || '';\nconst contactName = contactRecord.contactName || `${contactFirstName} ${contactLastName}`.trim() || 'Unknown Contact';\nconst recepientEmail = contactRecord.recepientEmail || contactRecord.recipientEmail || '';\nconst contactTitle = contactRecord.contactJobTitle || contactRecord.contactTitle || '';\n\n// ‚úÖ FIXED v2.0: Extract email template information from outreachData\nconst emailSubject = outreachData.emailSubject || contactRecord.emailSubject || '';\nconst emailBody = outreachData.emailBody || contactRecord.emailBody || '';\n\n// ‚úÖ FIXED v2.0: Extract duplicate detection fields from contactRecord\nconst isDuplicate = Boolean(contactRecord.isDuplicate || false);\nconst duplicateCount = contactRecord.duplicateCount || 0;\nconst duplicateReason = contactRecord.duplicateReason || '';\nconst originalApplicationDate = contactRecord.originalApplicationDate || '';\nconst duplicateDetectedAt = contactRecord.duplicateDetectedAt || '';\n\n// Validate contact email\nif (!recepientEmail) {\n  throw new Error('Invalid contact data: missing recipient email');\n}\n\n// ‚úÖ FIXED v2.0: Extract resume data (if available)\nconst resumeData = contactRecord.resume || {};\nconst resumeContentFinal = resumeData.customizedContent || contactRecord.content || '';\nconst resumeMatchScoreFinal = resumeData.matchScore || contactRecord.resumeMatchScore || 0;\nconst qualificationScoreFinal = resumeData.qualificationScore || contactRecord.qualificationScore || 0;\n\n// ‚úÖ FIXED v2.0: Create properly structured outreach data\nconst outreachComponents = {\n  job: {\n    title: jobTitle,\n    company: companyName,\n    location: jobLocation,\n    jobUrl: jobUrl,\n    description: jobDescription\n  },\n  contact: {\n    name: contactName,\n    firstName: contactFirstName,\n    lastName: contactLastName,\n    email: recepientEmail,\n    jobTitle: contactTitle,\n    company: companyName\n  },\n  resume: {\n    customizedContent: resumeContentFinal,\n    matchScore: resumeMatchScoreFinal,\n    qualificationScore: qualificationScoreFinal,\n    dataSource: resumeContentFinal ? 'CONTACT_RECORD' : 'NONE',\n    dataAvailable: !!resumeContentFinal\n  },\n  email: {\n    subject: emailSubject,\n    body: emailBody,\n    template: 'job-application-outreach',\n    estimatedResponseRate: outreachData.estimatedResponseRate || 0\n  },\n  tracking: {\n    dedupeKey: contactRecord.dedupeKey || '',\n    trackingId: contactRecord.trackingId || '',\n    status: contactRecord.status || 'PREPARED',\n    priorityLevel: contactRecord.priorityLevel || 'MEDIUM',\n    processedAt: contactRecord.processedAt || new Date().toISOString()\n  },\n  candidate: {\n    name: "Ivo Dachev",\n    firstName: "Ivo",\n    lastName: "Dachev",\n    email: "dachevivo@gmail.com",\n    phone: "+1 (650)-222-7923",\n    linkedin: "https://www.linkedin.com/in/ivodachev/"\n  },\n  isDuplicate: isDuplicate,\n  duplicateCount: duplicateCount,\n  duplicateReason: duplicateReason,\n  originalApplicationDate: originalApplicationDate,\n  duplicateDetectedAt: duplicateDetectedAt,\n  outreachType: 'job-application-email',\n  timestamp: new Date().toISOString(),\n  originalInput: inputData,\n  diagnostics: {\n    resumeDataAvailable: !!resumeContentFinal,\n    resumeDataSource: resumeContentFinal ? 'CONTACT_RECORD' : 'NONE',\n    resumeContentLength: resumeContentFinal.length,\n    inputDataKeys: Object.keys(inputData),\n    contactRecordKeys: Object.keys(contactRecord),\n    outreachDataKeys: Object.keys(outreachData),\n    fixVersion: 'v2.0-NESTED-STRUCTURE-FIX'\n  }\n};\n\nconsole.log('‚úÖ Outreach Input Processing Success (v2.0):');\nconsole.log('   Job: ' + jobTitle + ' at ' + companyName);\nconsole.log('   Contact: ' + contactName + ' (' + recepientEmail + ')');\nconsole.log('   Contact First Name: ' + contactFirstName);\nconsole.log('   Candidate: ' + outreachComponents.candidate.name);\nconsole.log('   Resume Data Source: ' + outreachComponents.resume.dataSource);\nconsole.log('   Resume Content Length: ' + resumeContentFinal.length + ' characters');\nconsole.log('   Email Subject: ' + emailSubject);\nconsole.log('   Tracking Status: ' + contactRecord.status);\nconsole.log('   üîç Duplicate Detection: isDuplicate=' + isDuplicate + ', duplicateCount=' + duplicateCount);\nconsole.log('   üìã Processing Path: ' + (isDuplicate ? 'DUPLICATE_DETECTED - Skip Email' : 'NEW_APPLICATION - Generate Email + Resume PDF'));\nconsole.log('   ‚úÖ Data Structure Fix Applied: v2.0');\n\nreturn [{ \n  json: outreachComponents,\n  binary: $input.item.binary,  // ‚Üê MUST BE PRESENT\n  pairedItem: { item: 0 }\n}];\n"
                                     },
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -1728,
                                       -560
                                   ],
                      "id":  "10a9e21c-0b8d-4573-bee3-d93e85bce036",
                      "name":  "Outreach Input Processing"
                  },
                  {
                      "parameters":  {
                                         "modelId":  {
                                                         "__rl":  true,
                                                         "value":  "models/gemini-2.5-flash",
                                                         "mode":  "list",
                                                         "cachedResultName":  "models/gemini-2.5-flash"
                                                     },
                                         "messages":  {
                                                          "values":  [
                                                                         {
                                                                             "content":  "={{ `You are an expert Email Outreach AI that creates personalized job application emails.\n\n**CRITICAL INSTRUCTION - READ CAREFULLY:**\nYou MUST use the ACTUAL candidate information provided below. DO NOT generate placeholder names, example names, or fictional candidate data under ANY circumstances.\n\n**ACTUAL CANDIDATE INFORMATION (USE EXACTLY AS PROVIDED):**\n- Candidate Name: ${$json.candidate.name}\n- Candidate Email: ${$json.candidate.email}\n- Candidate Phone: ${$json.candidate.phone}\n\n**VERIFICATION REQUIREMENT:**\nBefore returning your response, verify that the email signature contains EXACTLY this name: \"${$json.candidate.name}\"\nIf you find yourself using names like \"Alice\", \"Bob\", \"Jane\", \"John\", \"Alex\", or any other name that is NOT \"${$json.candidate.name}\", you have made a critical error and must regenerate the email.\n\n**INPUT DATA:**\nJob Information: ${JSON.stringify($json.job)}\nContact Information: ${JSON.stringify($json.contact)}\nResume Data: ${JSON.stringify($json.resume)}\nCandidate Information: ${JSON.stringify($json.candidate)}\n\n**EMAIL REQUIREMENTS:**\n\n1. **Recipient Greeting**: \n   - MUST use the contact's first name from the input data\n   - Contact First Name: ${$json.contact.firstName}\n   - If first name is available, use: \"Hi ${$json.contact.firstName},\"\n   - If first name is empty, use: \"Hi there,\"\n   - DO NOT use \"Dear Hiring Manager,\" - this is too formal and impersonal\n   - DO NOT use generic placeholder names\n\n2. **Candidate Signature (MANDATORY FORMAT):**\n   - MUST use EXACTLY this format with NO substitutions:\n   \nSincerely,\n${$json.candidate.name}\n${$json.candidate.phone}\n${$json.candidate.email}\n\n   - The candidate's name is: ${$json.candidate.name}\n   - The candidate's phone is: ${$json.candidate.phone}\n   - The candidate's email is: ${$json.candidate.email}\n   - DO NOT change these values\n   - DO NOT use placeholder names like \"Alice Wonderland\", \"Jane Doe\", \"John Smith\", \"Alex Johnson\", etc.\n\n3. **Professional Tone**: Formal but engaging business communication\n4. **Value Proposition**: Clearly articulate candidate's value to the company\n5. **Specific Examples**: Include relevant achievements and skills from resume data\n6. **Call to Action**: Request for interview or further discussion\n\n**EMAIL STRUCTURE:**\n\n**Subject Line**: \n- Format: \"Application for [Job Title] - [Candidate Name]\"\n- Use actual job title: ${$json.job.title}\n- Use actual candidate name: ${$json.candidate.name}\n- Example: \"Application for ${$json.job.title} - ${$json.candidate.name}\"\n\n**Greeting**: \n- Use: \"Dear ${$json.contact.firstName},\" (if first name is available)\n- Fallback: \"Dear Hiring Manager,\" (if first name is empty)\n\n**Opening** (CRITICAL - READ CAREFULLY): \n- Use DIRECT, CONFIDENT, PROACTIVE language\n- NEVER use passive phrases like:\n  ‚ùå \"I am writing to express my interest...\"\n  ‚ùå \"I am writing to express my enthusiastic interest...\"\n  ‚ùå \"I am reaching out to apply for...\"\n  ‚ùå \"I would like to express my interest...\"\n  \n- ALWAYS use direct, engaging openings like:\n  ‚úÖ \"I'm excited to learn about the [Job Title] role at [Company].\"\n  ‚úÖ \"I believe I'm an excellent fit for the [Job Title] position.\"\n  ‚úÖ \"I wanted to connect about the [Job Title] role - my [X years] of [skill] experience aligns perfectly with what you're building.\"\n  ‚úÖ \"I'm reaching out because [specific reason related to company/role].\"\n  \n- Reference the specific job title: ${$json.job.title}\n- Reference the company name: ${$json.job.company}\n- Sound like a confident professional, NOT a generic template\n- Be conversational but professional\n- Avoid sounding robotic or formulaic\n\n**Body**: \n- Qualifications and achievements from resume data\n- Value proposition specific to the role\n- 2-3 paragraphs maximum\n\n**Closing and Signature (CRITICAL - USE EXACT FORMAT)**: \nSincerely,\n${$json.candidate.name}\n${$json.candidate.phone}\n${$json.candidate.email}\n\n**OUTPUT FORMAT:**\nReturn a JSON array with ONE object containing:\n[\n  {\n    \"emailSubject\": \"Application for ${$json.job.title} - ${$json.candidate.name}\",\n    \"emailBody\": \"[Complete email body with greeting, body paragraphs, closing, and signature]\"\n  }\n]\n\n**FINAL VERIFICATION CHECKLIST:**\nBefore returning your response, verify:\n‚úì The email signature contains the name: ${$json.candidate.name}\n‚úì The email signature contains the phone: ${$json.candidate.phone}\n‚úì The email signature contains the email: ${$json.candidate.email}\n‚úì The subject line contains the name: ${$json.candidate.name}\n‚úì You have NOT used any placeholder names like Alice, Bob, Jane, John, Alex, etc.\n\nIf ANY of these checks fail, regenerate the email with the correct information.‡Æµ‡Æ§‡Æ±‡Øç‡Æï‡Ææ‡Æï}}"
                                                                         }
                                                                     ]
                                                      },
                                         "jsonOutput":  true,
                                         "options":  {

                                                     }
                                     },
                      "type":  "@n8n/n8n-nodes-langchain.googleGemini",
                      "typeVersion":  1,
                      "position":  [
                                       -1104,
                                       -544
                                   ],
                      "id":  "f3620add-99c8-4196-9a79-765dbee264a4",
                      "name":  "AI Email Generation",
                      "retryOnFail":  true,
                      "credentials":  {
                                          "googlePalmApi":  {
                                                                "id":  "iSUthz6TcizkpxHs",
                                                                "name":  "Google Gemini(PaLM) Api account 2"
                                                            }
                                      }
                  },
                  {
                      "parameters":  {
                                         "documentId":  {
                                                            "__rl":  true,
                                                            "mode":  "list",
                                                            "value":  ""
                                                        },
                                         "sheetName":  {
                                                           "__rl":  true,
                                                           "mode":  "list",
                                                           "value":  ""
                                                       }
                                     },
                      "type":  "n8n-nodes-base.googleSheets",
                      "typeVersion":  4.7,
                      "position":  [
                                       240,
                                       880
                                   ],
                      "id":  "0ab5aff8-80dc-405c-914f-d1448c7b50d3",
                      "name":  "Status Update",
                      "credentials":  {
                                          "googleSheetsOAuth2Api":  {
                                                                        "id":  "HnVkHdxofZiUvnda",
                                                                        "name":  "Google Sheets account"
                                                                    }
                                      },
                      "disabled":  true
                  },
                  {
                      "parameters":  {
                                         "conditions":  {
                                                            "options":  {
                                                                            "version":  2,
                                                                            "leftValue":  "",
                                                                            "caseSensitive":  true,
                                                                            "typeValidation":  "strict"
                                                                        },
                                                            "conditions":  [
                                                                               {
                                                                                   "id":  "38159f4e-c431-4295-952d-ca66a5bb6dbb",
                                                                                   "leftValue":  "={{ $json.isDuplicate }}",
                                                                                   "rightValue":  true,
                                                                                   "operator":  {
                                                                                                    "type":  "boolean",
                                                                                                    "operation":  "equals"
                                                                                                }
                                                                               }
                                                                           ],
                                                            "combinator":  "and"
                                                        },
                                         "options":  {

                                                     }
                                     },
                      "type":  "n8n-nodes-base.if",
                      "typeVersion":  2.2,
                      "position":  [
                                       -1408,
                                       -560
                                   ],
                      "id":  "92e36ff5-98d0-4a9e-aba8-7e87ab928b6f",
                      "name":  "If - Duplicate or not"
                  },
                  {
                      "parameters":  {

                                     },
                      "type":  "n8n-nodes-base.merge",
                      "typeVersion":  3.2,
                      "position":  [
                                       -192,
                                       880
                                   ],
                      "id":  "43342112-5031-4d86-9790-363458c9f550",
                      "name":  "Merge Duplicate and Email",
                      "alwaysOutputData":  false,
                      "executeOnce":  false,
                      "retryOnFail":  false
                  },
                  {
                      "parameters":  {
                                         "folderId":  "=1JVopeMINzt3sZfZGs4HIDKzs5u_3gG_p",
                                         "title":  "={{ 'TempResume_' + $('Outreach Input Processing').item.json.job.title.replace(/[^a-zA-Z0-9]/g, '_') + '_' + Date.now() }}"
                                     },
                      "type":  "n8n-nodes-base.googleDocs",
                      "typeVersion":  2,
                      "position":  [
                                       -1984,
                                       -272
                                   ],
                      "id":  "b11ad5c3-1338-4ae4-903b-bf8990393f0f",
                      "name":  "Create Resume Document",
                      "credentials":  {
                                          "googleDocsOAuth2Api":  {
                                                                      "id":  "nrRB0AHydhQRDsRy",
                                                                      "name":  "Google Docs account"
                                                                  }
                                      }
                  },
                  {
                      "parameters":  {
                                         "operation":  "update",
                                         "documentURL":  "={{ $json.id }}",
                                         "actionsUi":  {
                                                           "actionFields":  [
                                                                                {
                                                                                    "action":  "insert",
                                                                                    "text":  "={{ $('Outreach Input Processing').item.json.resume.customizedContent }}"
                                                                                }
                                                                            ]
                                                       }
                                     },
                      "type":  "n8n-nodes-base.googleDocs",
                      "typeVersion":  2,
                      "position":  [
                                       -1744,
                                       -272
                                   ],
                      "id":  "b86c3d80-89b1-4bc5-b823-88fdc9be1d85",
                      "name":  "Update a document",
                      "credentials":  {
                                          "googleDocsOAuth2Api":  {
                                                                      "id":  "nrRB0AHydhQRDsRy",
                                                                      "name":  "Google Docs account"
                                                                  }
                                      }
                  },
                  {
                      "parameters":  {
                                         "operation":  "download",
                                         "fileId":  {
                                                        "__rl":  true,
                                                        "value":  "={{ $('Create Resume Document').item.json.id }}",
                                                        "mode":  "id"
                                                    },
                                         "options":  {
                                                         "googleFileConversion":  {
                                                                                      "conversion":  {
                                                                                                         "docsToFormat":  "application/pdf"
                                                                                                     }
                                                                                  }
                                                     }
                                     },
                      "type":  "n8n-nodes-base.googleDrive",
                      "typeVersion":  3,
                      "position":  [
                                       -1472,
                                       -272
                                   ],
                      "id":  "ab7a9fb1-99a7-4983-af4e-1c59b1196c67",
                      "name":  "Export Resume as PDF",
                      "credentials":  {
                                          "googleDriveOAuth2Api":  {
                                                                       "id":  "LWh2S5mnOx3z4ThG",
                                                                       "name":  "Google Drive account"
                                                                   }
                                      }
                  },
                  {
                      "parameters":  {
                                         "mode":  "runOnceForEachItem",
                                         "jsCode":  "// RESUME FILENAME CUSTOMIZER (ENHANCED WITH EMAIL DATA PARSING)\n// Renames binary data and parses AI Email data for Draft Gmail node\n// FIXED: Parses JSON from AI Email Generation and provides clean data structure\n\nconst jobTitle = $('Outreach Input Processing').item.json.job.title;\nconst companyName = $('Outreach Input Processing').item.json.job.company;\nconst candidateName = \" Ivo Dachev\";\n\n// Clean strings for filename\nconst cleanJobTitle = jobTitle.replace(/[^a-zA-Z0-9]/g, '_');\nconst cleanCompanyName = companyName.replace(/[^a-zA-Z0-9]/g, '_');\nconst cleanCandidateName = candidateName.replace(/[^a-zA-Z0-9]/g, '_');\n\n// Generate dynamic filename\nconst filename = 'Resume_' + cleanCandidateName + '_' + cleanJobTitle + '_' + cleanCompanyName + '.pdf';\n\nconsole.log('üìÑ Resume Filename:', filename);\n\n// Get binary data from Google Drive export\nconst binaryData = $input.item.binary.data;\n\nif (!binaryData) {\n  throw new Error('No binary data found from Google Drive export');\n}\n\n// ‚úÖ FIXED: Parse AI Email data and extract email content\nconst aiEmailData = $('AI Email Generation').item.json;\n\nconsole.log('üîç AI Email Data Structure:');\nconsole.log('   Has content:', !!aiEmailData.content);\nconsole.log('   Has parts:', !!(aiEmailData.content && aiEmailData.content.parts));\nconsole.log('   Parts length:', aiEmailData.content && aiEmailData.content.parts ? aiEmailData.content.parts.length : 0);\n\n// Parse the JSON string from Gemini response with error handling\nlet emailSubject = 'Application for ' + jobTitle + ' - ' + candidateName;\nlet emailBody = 'Dear Hiring Manager,\\n\\n' + 'Please see my attached resume for the ' + jobTitle + ' position at ' + companyName + '.\\n\\n' + 'Sincerely,\\n' + candidateName;\n\ntry {\n  if (aiEmailData.content && aiEmailData.content.parts && aiEmailData.content.parts[0]) {\n    const textContent = aiEmailData.content.parts[0].text;\n    console.log('üìÑ Raw AI Response Text (first 200 chars):', textContent.substring(0, 200));\n    \n    const emailDataArray = JSON.parse(textContent);\n    console.log('‚úÖ JSON Parse Success');\n    console.log('   Array length:', emailDataArray.length);\n    \n    if (emailDataArray && emailDataArray.length > 0 && emailDataArray[0]) {\n      console.log('   Has emailSubject:', !!emailDataArray[0].emailSubject);\n      console.log('   Has emailBody:', !!emailDataArray[0].emailBody);\n      \n      emailSubject = emailDataArray[0].emailSubject || emailSubject;\n      emailBody = emailDataArray[0].emailBody || emailBody;\n      \n      console.log('‚úÖ Email Data Extracted Successfully');\n    } else {\n      console.warn('‚ö†Ô∏è Parsed array is empty or missing element at index 0');\n    }\n  } else {\n    console.warn('‚ö†Ô∏è AI Email data structure is missing content.parts[0]');\n  }\n} catch (error) {\n  console.error('‚ùå Failed to parse AI Email data:', error.message);\n  console.error('   Using fallback email content');\n}\n\nconsole.log('üìß Final Email Subject:', emailSubject);\nconsole.log('üìß Final Email Body Length:', emailBody.length);\nconsole.log('üìß Email Body Preview (first 100 chars):', emailBody.substring(0, 100));\n\n// Validate that we have string values (not undefined)\nif (typeof emailSubject !== 'string' || emailSubject.length === 0) {\n  console.error('‚ùå emailSubject is not a valid string, using fallback');\n  emailSubject = 'Application for ' + jobTitle + ' - ' + candidateName;\n}\n\nif (typeof emailBody !== 'string' || emailBody.length === 0) {\n  console.error('‚ùå emailBody is not a valid string, using fallback');\n  emailBody = 'Dear Hiring Manager,\\n\\n' + 'Please see my attached resume for the ' + jobTitle + ' position at ' + companyName + '.\\n\\n' + 'Sincerely,\\n' + candidateName;\n}\n\n// Return with renamed binary property and CLEAN email data\nreturn {\n  json: {\n    emailSubject: emailSubject,\n    emailBody: emailBody,\n    resumeFilename: filename,\n    resumeGenerated: true,\n    jobTitle: jobTitle,\n    companyName: companyName,\n    candidateName: candidateName,\n    originalAiResponse: aiEmailData  // Keep original for debugging\n  },\n  binary: {\n    resume: {\n      data: binaryData.data,\n      mimeType: 'application/pdf',\n      fileName: filename,\n      fileExtension: 'pdf'\n    }\n  }\n};\n\n"
                                     },
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -1248,
                                       -272
                                   ],
                      "id":  "977a16de-ac40-4864-8780-b36985a24d74",
                      "name":  "Resume Filename Customizer"
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// ============================================\\n// DYNAMIC PRIORITY-BASED ACCOUNT SELECTOR\\n// ============================================\\n// Purpose: Selects email account using priority-based weighted distribution\\n// Input: Counter from \"Filter to Row 2\" + Active accounts from \"Filter Active Accounts\"\\n// Output: Selected account + testMode flag + restored binary + restored email data\\n// Distribution: Tier 1 (‚â§20 emails/day) - Priority 1: 70%, Priority 2: 20%, Priority 99: 10%\\n// NEW: Reads testMode flag from Google Sheets for per-account draft/send control\\n// ============================================\\n\n// ============================================\\n// üìÖ WEEKLY CONFIGURATION (MANUAL ADJUSTMENT)\\n// ============================================\\n// Change this value every week based on your email volume:\n// Week 1 (20-25 emails/week): moduloBase = 10\\n// Week 2 (40 emails/week): moduloBase = 10\\n// Week 3 (60 emails/week): moduloBase = 20\\n// Week 4+ (100+ emails/week): moduloBase = 100\\nconst WEEKLY_MODULO_BASE = 10;  // ‚Üê CHANGE THIS VALUE WEEKLY\\n\n// Get active accounts from Google Sheets\\nconst activeAccounts = $('Filter Active Accounts').all();\\nconst activeCount = activeAccounts.length;\\n\nconsole.log('üìä Dynamic Priority-Based Account Selector (v7.0 - Test Mode Support)');\\nconsole.log('   Active accounts:', activeCount);\\nconsole.log('   üìÖ Weekly Modulo Base:', WEEKLY_MODULO_BASE);\\n\n// Get current counter from Google Sheets\\nconst rawCounter = $('Filter to Row 2 (Counter Only)').item.json.counter || 0;\\nconst currentCounter = parseInt(rawCounter, 10) || 0;\\n\n// ============================================\\n// STEP 1: Group accounts by priority level\\n// ============================================\\nconst priorityGroups = {\\n  1: [],\\n  2: [],\\n  99: []\\n};\\n\nactiveAccounts.forEach(account => {\\n  const priority = account.json.priority || 99;  // Default to Priority 99 if missing\\n  if (priorityGroups[priority]) {\\n    priorityGroups[priority].push(account);\\n  } else {\\n    // Handle custom priority values by defaulting to Priority 99\\n    priorityGroups[99].push(account);\\n  }
});\\n\nconsole.log('   Priority 1 accounts:', priorityGroups[1].length);\\nconsole.log('   Priority 2 accounts:', priorityGroups[2].length);\\nconsole.log('   Priority 99 accounts:', priorityGroups[99].length);\\n\n// ============================================\\n// STEP 2: Calculate distribution percentages (Tier 1 rules)\\n// ============================================\\nconst tierDistribution = {\\n  1: 70,   // Priority 1: 70%\\n  2: 20,   // Priority 2: 20%\\n  99: 10   // Priority 99: 10%\\n};\\n\nconst accountDistribution = [];\\n\nObject.keys(priorityGroups).forEach(priority => {\\n  const accounts = priorityGroups[priority];\\n  if (accounts.length > 0) {\\n    const priorityPercentage = tierDistribution[priority] || 0;\\n    const perAccountPercentage = priorityPercentage / accounts.length;\\n    \\n    accounts.forEach(account => {\\n      accountDistribution.push({\\n        account: account,\n        percentage: perAccountPercentage,\n        priority: priority\\n      });\\n      console.log(`   ${account.json.accountName}: ${perAccountPercentage.toFixed(1)}% (Priority ${priority})`);\\n    });\\n  }
});\\n\n// ============================================\\n// STEP 3: Build modulo ranges (ADAPTIVE BASE)\\n// ============================================\\nconst moduloBase = WEEKLY_MODULO_BASE;  // Use weekly configuration\\nlet currentSlot = 0;\\n\nconst accountRanges = accountDistribution.map(item => {\\n  // Calculate slots proportional to percentage\\n  const slots = Math.round((item.percentage / 100) * moduloBase);\\n  const startSlot = currentSlot;\\n  const endSlot = currentSlot + slots - 1;\\n  currentSlot += slots;\\n  \\n  return {\\n    account: item.account,\n    percentage: item.percentage,\n    priority: item.priority,\n    startSlot: startSlot,\n    endSlot: endSlot,\n    slots: slots\\n  };\\n});\\n\nconsole.log('   Modulo base:', moduloBase);\\naccountRanges.forEach(range => {\\n  console.log(`   ${range.account.json.accountName}: slots ${range.startSlot}-${range.endSlot} (${range.slots} slots)`);\\n});\\n\n// ============================================\\n// STEP 4: Select account based on counter\\n// ============================================\\nconst moduloValue = currentCounter % moduloBase;\\nlet selectedAccountData = null;\\nlet selectedRange = null;\\n\nfor (const range of accountRanges) {\\n  if (moduloValue >= range.startSlot && moduloValue <= range.endSlot) {\\n    selectedAccountData = range.account.json;\\n    selectedRange = range;\\n    break;\\n  }
}\\n\nif (!selectedAccountData) {\\n  throw new Error(`‚ùå ERROR: No account found for modulo value ${moduloValue}. This should never happen.`);\\n}\\n\nconst selectedAccount = selectedAccountData.accountName;\\nconst newCounter = currentCounter + 1;  // Increment counter (no modulo reset)\\n\n// ============================================\\n// ‚úÖ NEW: Read testMode flag from selected account\\n// ============================================\\nconst testMode = selectedAccountData.testMode;\\n// Handle various boolean representations (TRUE, true, 1, etc.)\\nconst isTestMode = testMode === true || testMode === 'TRUE' || testMode === 'true' || testMode === 1;\\n\\n// Default to FALSE (production mode) if testMode is missing or invalid\\nconst testModeValue = (testMode === undefined || testMode === null) ? false : isTestMode;\\n\\nconsole.log('   Current counter:', currentCounter);\\nconsole.log('   Modulo value:', moduloValue);\\nconsole.log('   ‚úÖ Selected account:', selectedAccount);\\nconsole.log('   Email address:', selectedAccountData.emailAddress);\\nconsole.log('   Priority:', selectedRange.priority);\\nconsole.log('   Percentage:', selectedRange.percentage.toFixed(1) + '%');\\nconsole.log('   üß™ Test Mode:', testModeValue ? 'ENABLED (Create Draft)' : 'DISABLED (Send Email)');\\n\\n// ============================================\\n// STEP 5: Restore ALL required data from upstream nodes\\n// ============================================\\nconst items = $input.all();\\n\nreturn items.map((item, index) => {\\n  return {\\n    json: {\\n      // ‚úÖ Restore email data from Resume Filename Customizer\\n      emailSubject: $('Resume Filename Customizer').item.json.emailSubject,\n      emailBody: $('Resume Filename Customizer').item.json.emailBody,\n      \\n      // Add counter data for Update Counter node\\n      counter: newCounter,\n      \\n      // Add account selection data\\n      selectedAccount: selectedAccount,  // e.g., 'gmail-dachevivo'\\n      emailAccount: selectedAccount,\n      emailAddress: selectedAccountData.emailAddress,\n      credentialName: selectedAccountData.credentialName,\n      priority: selectedRange.priority,\n      \\n      // ‚úÖ NEW: Add testMode flag to output\\n      testMode: testModeValue,\n      \\n      // Metadata\\n      accountSelectionMetadata: {\\n        itemIndex: index,\n        currentCounter: currentCounter,\n        newCounter: newCounter,\n        moduloValue: moduloValue,\n        moduloBase: moduloBase,\n        selectedAccount: selectedAccount,\n        selectedPriority: selectedRange.priority,\n        selectedPercentage: selectedRange.percentage,\n        activeAccountCount: activeCount,\n        distributionStrategy: 'ADAPTIVE-PRIORITY-BASED-WEIGHTED',\\n        tierRules: 'P1:70% P2:20% P99:10%',\\n        weeklyModuloBase: WEEKLY_MODULO_BASE,\n        testMode: testModeValue,  // ‚úÖ NEW: Add to metadata for tracking\\n        testModeSource: testMode === undefined || testMode === null ? 'DEFAULT_FALSE' : 'GOOGLE_SHEETS',\\n        fixVersion: 'v7.0-TEST-MODE-SUPPORT'\\n      }
    },\n    // ‚úÖ Restore binary from Daily Email Volume Control\\n    binary: $('Daily Email Volume Control').item.binary,\n    pairedItem: {\\n      item: index\\n    }
  };
});"
                                     },
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -544,
                                       -528
                                   ],
                      "id":  "3ce6eadb-cf2a-4432-a758-2c0f67b32a18",
                      "name":  "Dynamic Priority-Based Account Selector"
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// AGGREGATE EMAIL METRICS (4-ACCOUNT SYSTEM)\\n// Receives input from Gmail API Send OR one of 3 Outlook nodes\\n// Calculates daily email statistics for dashboard logging\\n// FIXED v6: Defensive checking for node execution status to prevent \"Referenced node doesn't exist\" errors\\n\nconst items = $input.all();\\n\nconsole.log('üìä Aggregate Email Metrics (v6 - 4-Account System with Defensive Checking)');\\nconsole.log('   Total items received:', items.length);\\n\n// Initialize counters for 4 accounts\\nlet gmailCount = 0;\\nlet outlook1Count = 0;\\nlet outlook2Count = 0;\\nlet outlook3Count = 0;\\nlet totalEmails = 0;\\nlet emailAccount = 'unknown';\\n\n// Get the first (and only) item from the email node\\nconst emailItem = items[0];\\n\nif (!emailItem) {\\n  throw new Error('No input received from email node');\\n}\\n\n// ‚úÖ FIX v6: Use defensive checking with try-catch to handle nodes that didn't execute\\n// N8N throws \"Referenced node doesn't exist\" error when accessing nodes that exist\\n// in the workflow but did not execute in the current execution\\n\nlet gmailApiSendExecuted = false;\\ntry {\\n  gmailApiSendExecuted = $('Gmail - dachevivo').isExecuted;\\n} catch (error) {\\n  gmailApiSendExecuted = false;\\n}\\n\nlet outlook1Executed = false;\\ntry {\\n  outlook1Executed = $('Inbox dachevivo').isExecuted;\\n} catch (error) {\\n  outlook1Executed = false;\\n}\\n\nlet outlook2Executed = false;\\ntry {\\n  outlook2Executed = $('Inbox dachevivo2').isExecuted;\\n} catch (error) {\\n  outlook2Executed = false;\\n}\\n\nlet outlook3Executed = false;\\ntry {\\n  outlook3Executed = $('Inbox dachevivo3').isExecuted;\\n} catch (error) {\\n  outlook3Executed = false;\\n}\\n\nconsole.log('   Gmail API Send executed:', gmailApiSendExecuted);\\nconsole.log('   Inbox Outlook (outlook1) executed:', outlook1Executed);\\nconsole.log('   dachevivo2@outlook (outlook2) executed:', outlook2Executed);\\nconsole.log('   dachevivo3@outlook.com (outlook3) executed:', outlook3Executed);\\n\n// Count the email for the appropriate account\\nif (gmailApiSendExecuted) {\\n  gmailCount = 1;\\n  emailAccount = 'gmail';\\n  console.log('   ‚úÖ Detected: Gmail email sent via API');\\n} else if (outlook1Executed) {\\n  outlook1Count = 1;\\n  emailAccount = 'outlook1';\\n  console.log('   ‚úÖ Detected: Outlook #1 draft created (dachevivo@outlook.com)');\\n} else if (outlook2Executed) {\\n  outlook2Count = 1;\\n  emailAccount = 'outlook2';\\n  console.log('   ‚úÖ Detected: Outlook #2 draft created (dachevivo2@outlook.com)');\\n} else if (outlook3Executed) {\\n  outlook3Count = 1;\\n  emailAccount = 'outlook3';\\n  console.log('   ‚úÖ Detected: Outlook #3 draft created (dachevivo3@outlook.com)');\\n} else {\\n  console.error('   ‚ùå ERROR: No email node executed!');\\n  console.error('   This should never happen in the current architecture.');\\n}\\n\n\ntotalEmails = 1; // Always 1 email per execution\\n\\n// Calculate percentages (will be 100% for whichever account was used)\\nconst gmailPercentage = gmailCount > 0 ? 100 : 0;\\nconst outlook1Percentage = outlook1Count > 0 ? 100 : 0;\\nconst outlook2Percentage = outlook2Count > 0 ? 100 : 0;\\nconst outlook3Percentage = outlook3Count > 0 ? 100 : 0;\\n\\n// ‚úÖ Convert timestamps to Pacific Time (America/Los_Angeles)\\nconst now = new Date();\\n\\n// Get Pacific Time string (automatically handles PST/PDT)\\nconst pacificTimeString = now.toLocaleString('en-US', {\\n  timeZone: 'America/Los_Angeles',\\n  year: 'numeric',\\n  month: '2-digit',\\n  day: '2-digit',\\n  hour: '2-digit',\\n  minute: '2-digit',\\n  second: '2-digit',\\n  hour12: false\\n});\\n\\n// Parse the Pacific Time string to get date and time components\\nconst [datePart, timePart] = pacificTimeString.split(', ');\\nconst [month, day, year] = datePart.split('/');\\nconst executionDate = `${year}-${month}-${day}`; // YYYY-MM-DD format\\n\\n// Create full timestamp in Pacific Time\\nconst executionTime = `${year}-${month}-${day} ${timePart}`;\\n\\nconsole.log('   üìÖ Execution Date (Pacific):', executionDate);\\nconsole.log('   ‚è∞ Execution Time (Pacific):', executionTime);\\nconsole.log('   üåê Original UTC Time:', now.toISOString());\\n\\n// Get execution metadata\\nconst workflowId = $workflow.id;\\nconst executionId = $execution.id;\\n\\n// ‚úÖ FIXED v7: Reference correct node name "Dynamic Priority-Based Account Selector"\\nconst counterValue = $('Dynamic Priority-Based Account Selector').item.json.accountSelectionMetadata.newCounter;\\nconsole.log('   üî¢ Counter Value:', counterValue);\\n\\n// Calculate bounce rates (placeholder - will be updated with actual data later)\\nconst gmailBounceRate = 0; // TODO: Integrate with actual bounce tracking\\nconst outlook1BounceRate = 0;\\nconst outlook2BounceRate = 0;\\nconst outlook3BounceRate = 0;\\n\\n// Determine account health status\\nconst gmailHealth = gmailCount > 0 ? 'HEALTHY' : 'INACTIVE';\\nconst outlook1Health = outlook1Count > 0 ? 'HEALTHY' : 'INACTIVE';\\nconst outlook2Health = outlook2Count > 0 ? 'HEALTHY' : 'INACTIVE';\\nconst outlook3Health = outlook3Count > 0 ? 'HEALTHY' : 'INACTIVE';\\n\\n// Create aggregated metrics object\\nconst aggregatedMetrics = {\\n  // Date and execution info (Pacific Time)\\n  executionDate: executionDate,\n  executionTime: executionTime,\n  workflowId: workflowId,\n  executionId: executionId,\n  \\n  // Counter\\n  counter: counterValue,\n  \\n  // Email counts (4 accounts)\\n  totalEmails: totalEmails,\n  gmailCount: gmailCount,\n  outlook1Count: outlook1Count,\n  outlook2Count: outlook2Count,\n  outlook3Count: outlook3Count,\n  \\n  // Distribution percentages (4 accounts)\\n  gmailPercentage: gmailPercentage,\n  outlook1Percentage: outlook1Percentage,\n  outlook2Percentage: outlook2Percentage,\n  outlook3Percentage: outlook3Percentage,\n  \\n  // Bounce rates (4 accounts)\\n  gmailBounceRate: gmailBounceRate,\n  outlook1BounceRate: outlook1BounceRate,\n  outlook2BounceRate: outlook2BounceRate,\n  outlook3BounceRate: outlook3BounceRate,\n  \\n  // Account health (4 accounts)\\n  gmailHealth: gmailHealth,\n  outlook1Health: outlook1Health,\n  outlook2Health: outlook2Health,\n  outlook3Health: outlook3Health,\n  \\n  // Metadata\\n  aggregationTimestamp: executionTime,\n  dataSource: 'OUTREACH_TRACKING_WORKFLOW',\\n  metricsVersion: 'v7.0-4-ACCOUNT-SYSTEM-NODE-REFERENCE-FIX',\\n  \\n  // Draft creation info\\n  draftCreatedBy: emailAccount,\n  draftCreatedAt: executionTime,\n  \\n  // Timezone info\\n  timezone: 'America/Los_Angeles (Pacific Time)',\\n  timezoneOffset: 'UTC-8 (PST) or UTC-7 (PDT)',\\n  \\n  // Debug info\\n  debugInfo: {\\n    gmailApiSendExecuted: gmailApiSendExecuted,\n    outlook1Executed: outlook1Executed,\n    outlook2Executed: outlook2Executed,\n    outlook3Executed: outlook3Executed,\n    detectedAccount: emailAccount,\n    itemsReceived: items.length,\n    fixVersion: 'v7.0-NODE-REFERENCE-FIX'\\n  }
};\\n\\nconsole.log('‚úÖ Aggregated Metrics Created (v7):');\\nconsole.log('   Total Emails:', totalEmails);\\nconsole.log('   Gmail Count:', gmailCount);\\nconsole.log('   Outlook #1 Count:', outlook1Count);\\nconsole.log('   Outlook #2 Count:', outlook2Count);\\nconsole.log('   Outlook #3 Count:', outlook3Count);\\nconsole.log('   Gmail Percentage:', gmailPercentage + '%');\\nconsole.log('   Outlook #1 Percentage:', outlook1Percentage + '%');\\nconsole.log('   Outlook #2 Percentage:', outlook2Percentage + '%');\\nconsole.log('   Outlook #3 Percentage:', outlook3Percentage + '%');\\nconsole.log('   Detected Account:', emailAccount);\\nconsole.log('   Counter Value:', counterValue);\\nconsole.log('   üõ°Ô∏è Defensive Checking Applied: SUCCESS');\\nconsole.log('   üîß Node Reference Fix Applied: v7.0');\\n\\n// Fetch original job application data from Outreach Input Processing\\nconst outreachData = $('Outreach Input Processing').item.json;\\n\\nconsole.log('üìã Job Application Data Preservation:');\\nconsole.log('   Job Title:', outreachData.job ? outreachData.job.title : 'N/A');\\nconsole.log('   Company:', outreachData.job ? outreachData.job.company : 'N/A');\\nconsole.log('   Contact Email:', outreachData.contact ? outreachData.contact.email : 'N/A');\\nconsole.log('   Tracking ID:', outreachData.tracking ? outreachData.tracking.trackingId : 'N/A');\\n\\n// Merge job application data with email metrics\\nconst completeData = {\\n  ...outreachData,  // All job application data (job, contact, resume, email, tracking, candidate, etc.)\\n  emailMetrics: aggregatedMetrics,  // Email metrics (Gmail + 3 Outlook accounts)\\n  emailSendingStatus: {\\n    emailSent: true,\n    emailAccount: emailAccount,\n    sentAt: executionTime,\n    executionId: executionId,\n    workflowId: workflowId\\n  }
};\\n\\nconsole.log('‚úÖ Complete Data Structure Created (v7):');\\nconsole.log('   Has job data:', !!completeData.job);\\nconsole.log('   Has contact data:', !!completeData.contact);\\nconsole.log('   Has resume data:', !!completeData.resume);\\nconsole.log('   Has email metrics:', !!completeData.emailMetrics);\\nconsole.log('   Has email sending status:', !!completeData.emailSendingStatus);\\nconsole.log('   Data preservation: SUCCESS');\\n\\nreturn [{ json: completeData }];
"
                                     },
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -752,
                                       896
                                   ],
                      "id":  "d78293cc-3083-4529-9194-3035d6a3d69b",
                      "name":  "Aggregate Email Metrics"
                  },
                  {
                      "parameters":  {
                                         "maxItems":  15
                                     },
                      "type":  "n8n-nodes-base.limit",
                      "typeVersion":  1,
                      "position":  [
                                       -992,
                                       -272
                                   ],
                      "id":  "50486a8c-8aa7-40da-862e-1956daa18b84",
                      "name":  "Daily Email Volume Control"
                  },
                  {
                      "parameters":  {
                                         "operation":  "appendOrUpdate",
                                         "documentId":  {
                                                            "__rl":  true,
                                                            "value":  "1NgFM2ujALlcApbyAuYNWJ5Hyf0UkO0efQlGAzoifC8c",
                                                            "mode":  "list"
                                                        },
                                         "sheetName":  {
                                                           "__rl":  true,
                                                           "value":  "gid=0",
                                                           "mode":  "list",
                                                           "cachedResultName":  "Email Daily Tracking",
                                                           "cachedResultUrl":  "https://docs.google.com/spreadsheets/d/1NgFM2ujALlcApbyAuYNWJ5Hyf0UkO0efQlGAzoifC8c/edit#gid=0"
                                                       },
                                         "columns":  {
                                                         "mappingMode":  "defineBelow",
                                                         "value":  {
                                                                       "id":  "COUNTER"
                                                                   },
                                                         "matchingColumns":  [
                                                                                 "id"
                                                                             ],
                                                         "schema":  [
                                                                        {
                                                                            "id":  "id",
                                                                            "displayName":  "id",
                                                                            "required":  false,
                                                                            "defaultMatch":  true,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  false
                                                                        },
                                                                        {
                                                                            "id":  "counter",
                                                                            "displayName":  "counter",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "executionDate",
                                                                            "displayName":  "executionDate",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "executionTime",
                                                                            "displayName":  "executionTime",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "totalEmails",
                                                                            "displayName":  "totalEmails",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "gmailCount",
                                                                            "displayName":  "gmailCount",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlookCount",
                                                                            "displayName":  "outlookCount",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook1Count",
                                                                            "displayName":  "outlook1Count",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook2Count",
                                                                            "displayName":  "outlook2Count",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook3Count",
                                                                            "displayName":  "outlook3Count",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "gmailPercentage",
                                                                            "displayName":  "gmailPercentage",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlookPercentage",
                                                                            "displayName":  "outlookPercentage",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook1Percentage",
                                                                            "displayName":  "outlook1Percentage",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook2Percentage",
                                                                            "displayName":  "outlook2Percentage",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook3Percentage",
                                                                            "displayName":  "outlook3Percentage",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "gmailBounceRate",
                                                                            "displayName":  "gmailBounceRate",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlookBounceRate",
                                                                            "displayName":  "outlookBounceRate",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook1BounceRate",
                                                                            "displayName":  "outlook1BounceRate",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook2BounceRate",
                                                                            "displayName":  "outlook2BounceRate",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook3BounceRate",
                                                                            "displayName":  "outlook3BounceRate",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "gmailHealth",
                                                                            "displayName":  "gmailHealth",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlookHealth",
                                                                            "displayName":  "outlookHealth",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook1Health",
                                                                            "displayName":  "outlook1Health",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook2Health",
                                                                            "displayName":  "outlook2Health",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "outlook3Health",
                                                                            "displayName":  "outlook3Health",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "workflowId",
                                                                            "displayName":  "workflowId",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "executionId",
                                                                            "displayName":  "executionId",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "aggregationTimestamp",
                                                                            "displayName":  "aggregationTimestamp",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "dataSource",
                                                                            "displayName":  "dataSource",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "metricsVersion",
                                                                            "displayName":  "metricsVersion",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "draftCreatedBy",
                                                                            "displayName":  "draftCreatedBy",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "draftCreatedAt",
                                                                            "displayName":  "draftCreatedAt",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "timezone",
                                                                            "displayName":  "timezone",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "timezoneOffset",
                                                                            "displayName":  "timezoneOffset",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        },
                                                                        {
                                                                            "id":  "debugInfo",
                                                                            "displayName":  "debugInfo",
                                                                            "required":  false,
                                                                            "defaultMatch":  false,
                                                                            "display":  true,
                                                                            "type":  "string",
                                                                            "canBeUsedToMatch":  true,
                                                                            "removed":  true
                                                                        }
                                                                    ],
                                                         "attemptToConvertTypes":  false,
                                                         "convertFieldsToString":  false
                                                     },
                                         "options":  {

                                                     }
                                     },
                      "type":  "n8n-nodes-base.googleSheets",
                      "typeVersion":  4.7,
                      "position":  [
                                       224,
                                       -480
                                   ],
                      "id":  "eca027ea-a48f-4ca5-894a-de73f10662f0",
                      "name":  "Update Counter",
                      "credentials":  {
                                          "googleSheetsOAuth2Api":  {
                                                                        "id":  "HnVkHdxofZiUvnda",
                                                                        "name":  "Google Sheets account"
                                                                    }
                                      }
                  },
                  {
                      "parameters":  {
                                         "documentId":  {
                                                            "__rl":  true,
                                                            "mode":  "id",
                                                            "value":  "1NgFM2ujALlcApbyAuYNWJ5Hyf0UkO0efQlGAzoifC8c"
                                                        },
                                         "sheetName":  {
                                                           "__rl":  true,
                                                           "value":  "gid=0",
                                                           "mode":  "list",
                                                           "cachedResultName":  "Email Daily Tracking"
                                                       },
                                         "options":  {

                                                     }
                                     },
                      "type":  "n8n-nodes-base.googleSheets",
                      "typeVersion":  4.7,
                      "position":  [
                                       -784,
                                       -272
                                   ],
                      "id":  "c724e498-eab9-4ad2-8e57-201e8af1c3b2",
                      "name":  "Read Counter",
                      "credentials":  {
                                          "googleSheetsOAuth2Api":  {
                                                                        "id":  "HnVkHdxofZiUvnda",
                                                                        "name":  "Google Sheets account"
                                                                    }
                                      }
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// Filter to only the counter row (id = \"COUNTER\" or id = 1 or row_number = 2)\\nconst items = $input.all();\\n\\n// Find the counter row using multiple criteria for robustness\\nconst counterRow = items.find(item => {\\n  const json = item.json;\\n  return json.id === \"COUNTER\" || \n         json.id === 1 || \n         json.row_number === 2;\\n});\\n\\n// Error handling: throw descriptive error if counter row not found\\nif (!counterRow) {\\n  throw new Error(\n    `Counter row not found in Google Sheets data. ` +\\n    `Expected row with id=\"COUNTER\" or id=1 or row_number=2. ` +\\n    `Received ${items.length} items from Read Counter node.`\\n  );\\n}\\n\\n// Return only the counter row as a single-item array\\nreturn [counterRow];"
                                     },
                      "id":  "filter-counter-row-node",
                      "name":  "Filter to Row 2 (Counter Only)",
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -560,
                                       -272
                                   ]
                  },
                  {
                      "parameters":  {
                                         "method":  "POST",
                                         "url":  "https://gmail.googleapis.com/gmail/v1/users/me/messages/send",
                                         "authentication":  "predefinedCredentialType",
                                         "nodeCredentialType":  "googleOAuth2Api",
                                         "sendHeaders":  true,
                                         "headerParameters":  {
                                                                  "parameters":  [
                                                                                     {
                                                                                         "name":  "Content-Type",
                                                                                         "value":  "application/json"
                                                                                     }
                                                                                 ]
                                                              }, 
                                         "sendBody":  true,
                                         "specifyBody":  "json",
                                         "jsonBody":  "={{ { \"raw\": $json.raw } }}",
                                         "options":  {

                                                     }
                                     },
                      "id":  "1b4e6d0e-c0fb-4187-a7e3-bab3abc8e2d6",
                      "name":  "Gmail - ivoddachev",
                      "type":  "n8n-nodes-base.httpRequest",
                      "typeVersion":  4.2,
                      "position":  [
                                       -1328,
                                       672
                                   ],
                      "credentials":  {
                                          "googleOAuth2Api":  {
                                                                  "id":  "w8nTWzWPswftVYqH",
                                                                  "name":  "Google account"
                                                              }
                                      }
                  },
                  {
                      "parameters":  {
                                         "method":  "POST",
                                         "url":  "https://gmail.googleapis.com/gmail/v1/users/me/messages/send",
                                         "authentication":  "predefinedCredentialType",
                                         "nodeCredentialType":  "googleOAuth2Api",
                                         "sendHeaders":  true,
                                         "headerParameters":  {
                                                                  "parameters":  [
                                                                                     {
                                                                                         "name":  "Content-Type",
                                                                                         "value":  "application/json"
                                                                                     }
                                                                                 ]
                                                              }, 
                                         "sendBody":  true,
                                         "specifyBody":  "json",
                                         "jsonBody":  "={{ { \"raw\": $json.raw } }}",
                                         "options":  {

                                                     }
                                     },
                      "id":  "61d7189f-c92e-4192-ad42-308dfc01f591",
                      "name":  "Gmail - dachevivo",
                      "type":  "n8n-nodes-base.httpRequest",
                      "typeVersion":  4.2,
                      "position":  [
                                       -1360,
                                       496
                                   ],
                      "credentials":  {
                                          "googleOAuth2Api":  {
                                                                  "id":  "w8nTWzWPswftVYqH",
                                                                  "name":  "Google account"
                                                              }
                                      }
                  },
                  {
                      "parameters":  {
                                         "method":  "POST",
                                         "url":  "https://gmail.googleapis.com/gmail/v1/users/me/messages/send",
                                         "authentication":  "predefinedCredentialType",
                                         "nodeCredentialType":  "googleOAuth2Api",
                                         "sendHeaders":  true,
                                         "headerParameters":  {
                                                                  "parameters":  [
                                                                                     {
                                                                                         "name":  "Content-Type",
                                                                                         "value":  "application/json"
                                                                                     }
                                                                                 ]
                                                              }, 
                                         "sendBody":  true,
                                         "specifyBody":  "json",
                                         "jsonBody":  "={{ { \"raw\": $json.raw } }}",
                                         "options":  {

                                                     }
                                     },
                      "id":  "61cb0ea6-b007-44a6-8a50-ea0c949441aa",
                      "name":  "Gmail - ivodachevd",
                      "type":  "n8n-nodes-base.httpRequest",
                      "typeVersion":  4.2,
                      "position":  [
                                       -1280,
                                       864
                                   ],
                      "credentials":  {
                                          "googleOAuth2Api":  {
                                                                  "id":  "w8nTWzWPswftVYqH",
                                                                  "name":  "Google account"
                                                              }
                                      }
                  },
                  {
                      "parameters":  {
                                         "rules":  {
                                                       "values":  [
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "caseSensitive":  true,
                                                                                                             "leftValue":  "",
                                                                                                             "typeValidation":  "strict",
                                                                                                             "version":  2
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "gmail-dachevivo",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 }
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "caseSensitive":  true,
                                                                                                             "leftValue":  "",
                                                                                                             "typeValidation":  "strict",
                                                                                                             "version":  2
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "gmail-ivoddachev",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 }
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "caseSensitive":  true,
                                                                                                             "leftValue":  "",
                                                                                                             "typeValidation":  "strict",
                                                                                                             "version":  2
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "gmail-ivodachevd",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 }
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "caseSensitive":  true,
                                                                                                             "leftValue":  "",
                                                                                                             "typeValidation":  "strict",
                                                                                                             "version":  2
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "outlook-dachevivo",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 }
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "caseSensitive":  true,
                                                                                                             "leftValue":  "",
                                                                                                             "typeValidation":  "strict",
                                                                                                             "version":  2
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "outlook-dachevivo2",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 }
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "caseSensitive":  true,
                                                                                                             "leftValue":  "",
                                                                                                             "typeValidation":  "strict",
                                                                                                             "version":  2
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "outlook-dachevivo3",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 }
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       }
                                                                  ]
                                                   },
                                         "options":  {

                                                     }
                                     },
                      "id":  "4account-email-router-switch",
                      "name":  "6-Account Email Router",
                      "type":  "n8n-nodes-base.switch",
                      "typeVersion":  3.2,
                      "position":  [
                                       -1952,
                                       128
                                   ]
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// ============================================\\n// FILTER ACTIVE ACCOUNTS\\n// ============================================\\n// Purpose: Filter to only enabled email accounts from Google Sheets\\n// Input: All rows from Email-Account-Config sheet\\n// Output: Only accounts where enabled = TRUE\\n// ============================================\\n\nconst items = $input.all();\\n\nconsole.log('üìß Filter Active Accounts');\\nconsole.log('   Total accounts in config:', items.length);\\n\n// Filter to only enabled accounts\\nconst activeAccounts = items.filter(item => {\\n  const enabled = item.json.enabled;\\n  // Handle various boolean representations\\n  const isEnabled = enabled === true || enabled === 'TRUE' || enabled === 'true' || enabled === 1;\\n  \\n  if (isEnabled) {\\n    console.log(`   ‚úÖ ACTIVE: ${item.json.accountName} (Priority ${item.json.priority})`);\\n  } else {\\n    console.log(`   ‚ùå DISABLED: ${item.json.accountName}`);\\n  }\\n  \\n  return isEnabled;\\n});\\n\\nif (activeAccounts.length === 0) {\\n  throw new Error('‚ùå ERROR: No active email accounts found in Email-Account-Config sheet. Please enable at least one account.');\\n}\\n\\nconsole.log('‚úÖ Active Accounts Count:', activeAccounts.length);\\n\\nreturn activeAccounts;"
                                     },
                      "id":  "filter-active-accounts-node",
                      "name":  "Filter Active Accounts",
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       0,
                                       -272
                                   ]
                  },
                  {
                      "parameters":  {
                                         "documentId":  {
                                                            "__rl":  true,
                                                            "value":  "1Eiwf8LVWfkVeuaVSiicIp-GaX1Po95wCVAeMH7BUr6g",
                                                            "mode":  "id"
                                                        },
                                         "sheetName":  {
                                                           "__rl":  true,
                                                           "mode":  "name",
                                                           "value":  "Email-Account-Config"
                                                       },
                                         "options":  {

                                                     }
                                     },
                      "id":  "read-email-account-config-node",
                      "name":  "Read Email-Account-Config",
                      "type":  "n8n-nodes-base.googleSheets",
                      "typeVersion":  4.7,
                      "position":  [
                                       -272,
                                       -272
                                   ],
                      "credentials":  {
                                          "googleSheetsOAuth2Api":  {
                                                                        "id":  "HnVkHdxofZiUvnda",
                                                                        "name":  "Google Sheets account"
                                                                    }
                                      }
                  },
                  {
                      "parameters":  {
                                         "operation":  "appendOrUpdate",
                                         "documentId":  {
                                                            "__rl":  true,
                                                            "value":  "1NgFM2ujALlcApbyAuYNWJ5Hyf0UkO0efQlGAzoifC8c",
                                                            "mode":  "id"
                                                        },
                                         "sheetName":  {
                                                           "__rl":  true,
                                                           "value":  "gid=0",
                                                           "mode":  "list",
                                                           "cachedResultName":  "Email Daily Tracking",
                                                           "cachedResultUrl":  "https://docs.google.com/spreadsheets/d/1NgFM2ujALlcApbyAuYNWJ5Hyf0UkO0efQlGAzoifC8c/edit#gid=0"
                                                       },
                                         "columns":  {
                                                         "mappingMode":  "defineBelow",
                                                         "value":  {
                                                                       "counter":  "={{ $json.emailMetrics.counter }}",
                                                                       "executionDate":  "={{ $json.emailMetrics.executionDate }}",
                                                                       "executionTime":  "={{ $json.emailMetrics.executionTime }}",
                                                                       "totalEmails":  "={{ $json.emailMetrics.totalEmails }}",
                                                                       "gmailCount":  "={{ $json.emailMetrics.gmailCount }}",
                                                                       "outlook1Count":  "={{ $json.emailMetrics.outlook1Count }}",
                                                                       "outlook2Count":  "={{ $json.emailMetrics.outlook2Count }}",
                                                                       "outlook3Count":  "={{ $json.emailMetrics.outlook3Count }}",
                                                                       "gmailPercentage":  "={{ $json.emailMetrics.gmailPercentage }}",
                                                                       "outlook1Percentage":  "={{ $json.emailMetrics.outlook1Percentage }}",
                                                                       "outlook2Percentage":  "={{ $json.emailMetrics.outlook2Percentage }}",
                                                                       "outlook3Percentage":  "={{ $json.emailMetrics.outlook3Percentage }}",
                                                                       "gmailBounceRate":  "={{ $json.emailMetrics.gmailBounceRate }}",
                                                                       "outlook1BounceRate":  "={{ $json.emailMetrics.outlook1BounceRate }}",
                                                                       "outlook2BounceRate":  "={{ $json.emailMetrics.outlook2BounceRate }}",
                                                                       "outlook3BounceRate":  "={{ $json.emailMetrics.outlook3BounceRate }}",
                                                                       "gmailHealth":  "={{ $json.emailMetrics.gmailHealth }}",
                                                                       "outlook1Health":  "={{ $json.emailMetrics.outlook1Health }}",
                                                                       "outlook2Health":  "={{ $json.emailMetrics.outlook2Health }}",
                                                                       "outlook3Health":  "={{ $json.emailMetrics.outlook3Health }}",
                                                                       "workflowId":  "={{ $json.emailMetrics.workflowId }}",
                                                                       "executionId":  "={{ $json.emailMetrics.executionId }}",
                                                                       "aggregationTimestamp":  "={{ $json.emailMetrics.aggregationTimestamp }}",
                                                                       "dataSource":  "={{ $json.emailMetrics.dataSource }}",
                                                                       "metricsVersion":  "={{ $json.emailMetrics.metricsVersion }}",
                                                                       "draftCreatedBy":  "={{ $json.emailMetrics.draftCreatedBy }}",
                                                                       "draftCreatedAt":  "={{ $json.emailMetrics.draftCreatedAt }}",
                                                                       "timezone":  "={{ $json.emailMetrics.timezone }}",
                                                                       "timezoneOffset":  "={{ $json.emailMetrics.timezoneOffset }}"
                                                                   },
                                                         "matchingColumns":  [
                                                                                 "counter"
                                                                             ]
                                                     },
                                         "options":  {

                                                     }
                                     },
                      "type":  "n8n-nodes-base.googleSheets",
                      "typeVersion":  4.7,
                      "position":  [
                                       80,
                                       1168
                                   ],
                      "id":  "a05da1bd-c207-42b4-9a9a-a5b2319fc8bf",
                      "name":  "Email Tracking Dashboard",
                      "credentials":  {
                                          "googleSheetsOAuth2Api":  {
                                                                        "id":  "HnVkHdxofZiUvnda",
                                                                        "name":  "Google Sheets account"
                                                                    }
                                      }
                  },
                  {
                      "parameters":  {
                                         "rules":  {
                                                       "values":  [
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "version":  2,
                                                                                                             "leftValue":  "",
                                                                                                             "caseSensitive":  true,
                                                                                                             "typeValidation":  "strict"
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.testMode }}",
                                                                                                                    "rightValue":  true,
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "boolean",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 }
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "version":  2,
                                                                                                             "leftValue":  "",
                                                                                                             "caseSensitive":  true,
                                                                                                             "typeValidation":  "strict"
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.testMode }}",
                                                                                                                    "rightValue":  false,
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "boolean",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 }
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       }
                                                                  ]
                                                   },
                                         "options":  {

                                                     }
                                     },
                      "type":  "n8n-nodes-base.switch",
                      "typeVersion":  3.2,
                      "position":  [
                                       -2272,
                                       416
                                   ],
                      "id":  "266d5f68-5642-4ab8-a2a4-a48f4fb4e1ba",
                      "name":  "Test Mode Router"
                  },
                  {
                      "parameters":  {
                                         "rules":  {
                                                       "values":  [
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "version":  2,
                                                                                                             "leftValue":  "",
                                                                                                             "caseSensitive":  true,
                                                                                                             "typeValidation":  "strict"
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "gmail-dachevivo",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 },
                                                                                     "id":  "8ca0a936-ab01-4de3-b92d-058988d5fa18"
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "version":  2,
                                                                                                             "leftValue":  "",
                                                                                                             "caseSensitive":  true,
                                                                                                             "typeValidation":  "strict"
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "gmail-ivoddachev",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 },
                                                                                     "id":  "984b905c-23e1-45b0-80d6-625fe85a0c59"
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "version":  2,
                                                                                                             "leftValue":  "",
                                                                                                             "caseSensitive":  true,
                                                                                                             "typeValidation":  "strict"
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "gmail-ivodachevd",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 },
                                                                                     "id":  "1730e3b3-dd60-4771-b742-433cc8e821e0"
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "version":  2,
                                                                                                             "leftValue":  "",
                                                                                                             "caseSensitive":  true,
                                                                                                             "typeValidation":  "strict"
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "outlook-dachevivo",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 },
                                                                                     "id":  "c1515262-fe25-421e-8dc2-d1b6a30e0947"
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "version":  2,
                                                                                                             "leftValue":  "",
                                                                                                             "caseSensitive":  true,
                                                                                                             "typeValidation":  "strict"
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "outlook-dachevivo2",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 },
                                                                                     "id":  "e42a0e27-c8f4-46e6-8334-cf89271e9dc6"
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       },
                                                                      {
                                                                          "conditions":  {
                                                                                             "options":  {
                                                                                                             "version":  2,
                                                                                                             "leftValue":  "",
                                                                                                             "caseSensitive":  true,
                                                                                                             "typeValidation":  "strict"
                                                                                                         },
                                                                                             "conditions":  [
                                                                                                                {
                                                                                                                    "leftValue":  "={{ $json.selectedAccount }}",
                                                                                                                    "rightValue":  "outlook-dachevivo3",
                                                                                                                    "operator":  {
                                                                                                                                     "type":  "string",
                                                                                                                                     "operation":  "equals"
                                                                                                                                 },
                                                                                     "id":  "53f67157-f002-4ab2-b5ed-9fbbd26a42cb"
                                                                                 }
                                                                             ],
                                                              "combinator":  "and"
                                                          }
                                       }
                                                                  ]
                                                   },
                                         "options":  {

                                                     }
                                     },
                      "type":  "n8n-nodes-base.switch",
                      "typeVersion":  3.2,
                      "position":  [
                                       -2032,
                                       1184
                                   ],
                      "id":  "da5142ab-2b06-4e96-abb0-dbecc06a072e",
                      "name":  "Draft Creation Router"
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// Gmail MIME Builder - Constructs RFC 2822 compliant multipart MIME email\n// Input: $json.emailSubject, $json.emailBody, binary data 'resume'\n// Output: Base64url encoded MIME message ready for Gmail API\n\nconst items = $input.all();\nconst outputItems = [];\n\nfor (const item of items) {\n  try {\n    // Extract input data\n    const subject = item.json.emailSubject;\n    const bodyText = item.json.emailBody;\n    const recipientEmail = $('Outreach Input Processing').item.json.contact.email;\n   //const recipientEmail = 'dachevivo@gmail.com';\n    const senderEmail = 'dachevivo@gmail.com';\n    \n    // Get resume PDF binary data\n    const resumeBinary = item.binary.resume;\n    if (!resumeBinary) {\n      throw new Error('Resume binary data not found');\n    }\n    \n    // Convert binary data to base64\n    const resumeBase64 = resumeBinary.data;\n    const resumeFilename = item.json.resumeFilename || 'Resume.pdf';\n    \n    // Generate unique MIME boundaries\n    const boundaryMixed = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    const boundaryAlt = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    \n    // Convert plain text body (preserve newlines)\n    const plainTextBody = bodyText;\n    \n    // Convert HTML body (replace \\n\\n with <br><br>, \\n with <br>)\n    const htmlBody = '<div style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6;\">' +\n      bodyText.replace(/\\n\\n/g, '<br><br>').replace(/\\n/g, '<br>') +\n      '</div>';\n    \n    // Construct RFC 2822 compliant MIME message\n    const mimeMessage = [\n      `From: ${senderEmail}`,\n      `To: ${recipientEmail}`,\n      `Subject: ${subject}`,\n      `MIME-Version: 1.0`,\n      `Content-Type: multipart/mixed; boundary=\"${boundaryMixed}\"`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: multipart/alternative; boundary=\"${boundaryAlt}\"`,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/plain; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      plainTextBody,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/html; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      htmlBody,\n      ``,\n      `--${boundaryAlt}--`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: application/pdf; name=\"${resumeFilename}\"`,\n      `Content-Disposition: attachment; filename=\"${resumeFilename}\"`,\n      `Content-Transfer-Encoding: base64`,\n      ``,\n      resumeBase64,\n      ``,\n      `--${boundaryMixed}--`\n    ].join('\\r\\n');\n    \n    // Base64url encode the entire MIME message\n    const base64Message = Buffer.from(mimeMessage, 'utf-8').toString('base64');\n    const base64urlMessage = base64Message\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n      .replace(/=+$/, '');\n    \n    // Output for HTTP Request node\n    outputItems.push({\n      json: {\n        raw: base64urlMessage,\n        subject: subject,\n        recipient: recipientEmail,\n        mimeSize: mimeMessage.length\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n    \n  } catch (error) {\n    outputItems.push({\n      json: {\n        error: error.message,\n        subject: item.json.emailSubject || 'Unknown',\n        recipient: $('Outreach Input Processing').item.json.contact.email\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n  }\n}\n\nreturn outputItems;"
                                     },
                      "id":  "05fa624e-cb28-4b76-9eb9-853b6170eee2",
                      "name":  "Gmail MIME Builder",
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -1728,
                                       512
                                   ]
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// Gmail MIME Builder - Constructs RFC 2822 compliant multipart MIME email\n// Input: $json.emailSubject, $json.emailBody, binary data 'resume'\n// Output: Base64url encoded MIME message ready for Gmail API\n\nconst items = $input.all();\nconst outputItems = [];\n\nfor (const item of items) {\n  try {\n    // Extract input data\n    const subject = item.json.emailSubject;\n    const bodyText = item.json.emailBody;\n    const recipientEmail = $('Outreach Input Processing').item.json.contact.email;\n    //const recipientEmail = 'dachevivo@gmail.com';\n    const senderEmail = 'dachevivo@gmail.com';\n    \n    // Get resume PDF binary data\n    const resumeBinary = item.binary.resume;\n    if (!resumeBinary) {\n      throw new Error('Resume binary data not found');\n    }\n    \n    // Convert binary data to base64\n    const resumeBase64 = resumeBinary.data;\n    const resumeFilename = item.json.resumeFilename || 'Resume.pdf';\n    \n    // Generate unique MIME boundaries\n    const boundaryMixed = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    const boundaryAlt = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    \n    // Convert plain text body (preserve newlines)\n    const plainTextBody = bodyText;\n    \n    // Convert HTML body (replace \\n\\n with <br><br>, \\n with <br>)\n    const htmlBody = '<div style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6;\">' +\n      bodyText.replace(/\\n\\n/g, '<br><br>').replace(/\\n/g, '<br>') +\n      '</div>';\n    \n    // Construct RFC 2822 compliant MIME message\n    const mimeMessage = [\n      `From: ${senderEmail}`,\n      `To: ${recipientEmail}`,\n      `Subject: ${subject}`,\n      `MIME-Version: 1.0`,\n      `Content-Type: multipart/mixed; boundary=\"${boundaryMixed}\"`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: multipart/alternative; boundary=\"${boundaryAlt}\"`,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/plain; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      plainTextBody,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/html; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      htmlBody,\n      ``,\n      `--${boundaryAlt}--`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: application/pdf; name=\"${resumeFilename}\"`,\n      `Content-Disposition: attachment; filename=\"${resumeFilename}\"`,\n      `Content-Transfer-Encoding: base64`,\n      ``,\n      resumeBase64,\n      ``,\n      `--${boundaryMixed}--`\n    ].join('\\r\\n');\n    \n    // Base64url encode the entire MIME message\n    const base64Message = Buffer.from(mimeMessage, 'utf-8').toString('base64');\n    const base64urlMessage = base64Message\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n      .replace(/=+$/, '');\n    \n    // Output for HTTP Request node\n    outputItems.push({\n      json: {\n        raw: base64urlMessage,\n        subject: subject,\n        recipient: recipientEmail,\n        mimeSize: mimeMessage.length\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n    \n  } catch (error) {\n    outputItems.push({\n      json: {\n        error: error.message,\n        subject: item.json.emailSubject || 'Unknown',\n        recipient: $('Outreach Input Processing').item.json.contact.email\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n  }\n}\n\nreturn outputItems;"
                                     },
                      "id":  "61eecf23-190d-4ae9-b868-14c472545d91",
                      "name":  "Gmail MIME Builder1",
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -1696,
                                       688
                                   ]
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// Gmail MIME Builder - Constructs RFC 2822 compliant multipart MIME email\n// Input: $json.emailSubject, $json.emailBody, binary data 'resume'\n// Output: Base64url encoded MIME message ready for Gmail API\n\nconst items = $input.all();\nconst outputItems = [];\n\nfor (const item of items) {\n  try {\n    // Extract input data\n    const subject = item.json.emailSubject;\n    const bodyText = item.json.emailBody;\n    const recipientEmail = $('Outreach Input Processing').item.json.contact.email;\n    //const recipientEmail = 'dachevivo@gmail.com';\n    const senderEmail = 'dachevivo@gmail.com';\n    \n    // Get resume PDF binary data\n    const resumeBinary = item.binary.resume;\n    if (!resumeBinary) {\n      throw new Error('Resume binary data not found');\n    }\n    \n    // Convert binary data to base64\n    const resumeBase64 = resumeBinary.data;\n    const resumeFilename = item.json.resumeFilename || 'Resume.pdf';\n    \n    // Generate unique MIME boundaries\n    const boundaryMixed = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    const boundaryAlt = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    \n    // Convert plain text body (preserve newlines)\n    const plainTextBody = bodyText;\n    \n    // Convert HTML body (replace \\n\\n with <br><br>, \\n with <br>)\n    const htmlBody = '<div style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6;\">' +\n      bodyText.replace(/\\n\\n/g, '<br><br>').replace(/\\n/g, '<br>') +\n      '</div>';\n    \n    // Construct RFC 2822 compliant MIME message\n    const mimeMessage = [\n      `From: ${senderEmail}`,\n      `To: ${recipientEmail}`,\n      `Subject: ${subject}`,\n      `MIME-Version: 1.0`,\n      `Content-Type: multipart/mixed; boundary=\"${boundaryMixed}\"`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: multipart/alternative; boundary=\"${boundaryAlt}\"`,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/plain; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      plainTextBody,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/html; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      htmlBody,\n      ``,\n      `--${boundaryAlt}--`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: application/pdf; name=\"${resumeFilename}\"`,\n      `Content-Disposition: attachment; filename=\"${resumeFilename}\"`,\n      `Content-Transfer-Encoding: base64`,\n      ``,\n      resumeBase64,\n      ``,\n      `--${boundaryMixed}--`\n    ].join('\\r\\n');\n    \n    // Base64url encode the entire MIME message\n    const base64Message = Buffer.from(mimeMessage, 'utf-8').toString('base64');\n    const base64urlMessage = base64Message\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n      .replace(/=+$/, '');\n    \n    // Output for HTTP Request node\n    outputItems.push({\n      json: {\n        raw: base64urlMessage,\n        subject: subject,\n        recipient: recipientEmail,\n        mimeSize: mimeMessage.length\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n    \n  } catch (error) {\n    outputItems.push({\n      json: {\n        error: error.message,\n        subject: item.json.emailSubject || 'Unknown',\n        recipient: $('Outreach Input Processing').item.json.contact.email\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n  }\n}\n\nreturn outputItems;"
                                     },
                      "id":  "03b5d99f-0520-427b-8839-f76b4285f100",
                      "name":  "Gmail MIME Builder2",
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -1648,
                                       880
                                   ]
                  },
                  {
                      "parameters":  {
                                         "toRecipients":  "={{ $json.recepientEmail }}",
                                         "subject":  "={{ $json.emailSubject }}",
                                         "bodyContent":  "={{ $json.emailBody }}",
                                         "additionalFields":  {
                                                                  "attachments":  {
                                                                                      "attachments":  [
                                                                                                          {
                                                                                                              "binaryPropertyName":  "resume"
                                                                                                          }
                                                                                                      ]
                                                                                  }
                                                              }
                                     },
                      "type":  "n8n-nodes-base.microsoftOutlook",
                      "typeVersion":  2,
                      "position":  [
                                       -1312,
                                       1088
                                   ],
                      "id":  "ab5706ab-a260-4a82-a678-86db9558dbd8",
                      "name":  "Draft dachevivo",
                      "webhookId":  "fe8a1e12-3fe8-469b-9279-5c98e99c09a1",
                      "credentials":  {
                                          "microsoftOutlookOAuth2Api":  {
                                                                            "id":  "nfaK9aEhGOnLLHC4",
                                                                            "name":  "Microsoft Outlook account"
                                                                        }
                                      }
                  },
                  {
                      "parameters":  {
                                         "toRecipients":  "={{ $json.recepientEmail }}",
                                         "subject":  "={{ $json.emailSubject }}",
                                         "bodyContent":  "={{ $json.emailBody }}",
                                         "additionalFields":  {
                                                                  "attachments":  {
                                                                                      "attachments":  [
                                                                                                          {
                                                                                                              "binaryPropertyName":  "resume"
                                                                                                          }
                                                                                                      ]
                                                                                  }
                                                              }
                                     },
                      "type":  "n8n-nodes-base.microsoftOutlook",
                      "typeVersion":  2,
                      "position":  [
                                       -1312,
                                       1264
                                   ],
                      "id":  "815f7071-bd1e-401d-8e1c-aafecbf5eb61",
                      "name":  "draft dachevivo2",
                      "webhookId":  "fe8a1e12-3fe8-469b-9279-5c98e99c09a1",
                      "credentials":  {
                                          "microsoftOutlookOAuth2Api":  {
                                                                            "id":  "nrD1wFbznQD78xNa",
                                                                            "name":  "Microsoft Outlook account 2"
                                                                        }
                                      }
                  },
                  {
                      "parameters":  {
                                         "toRecipients":  "={{ $json.recepientEmail }}",
                                         "subject":  "={{ $json.emailSubject }}",
                                         "bodyContent":  "={{ $json.emailBody }}",
                                         "additionalFields":  {
                                                                  "attachments":  {
                                                                                      "attachments":  [
                                                                                                          {
                                                                                                              "binaryPropertyName":  "resume"
                                                                                                          }
                                                                                                      ]
                                                                                  }
                                                              }
                                     },
                      "type":  "n8n-nodes-base.microsoftOutlook",
                      "typeVersion":  2,
                      "position":  [
                                       -1312,
                                       1440
                                   ],
                      "id":  "ee332a5f-24ec-47b0-8804-8b4380a9fdaa",
                      "name":  "Draft dachevivo3",
                      "webhookId":  "fe8a1e12-3fe8-469b-9279-5c98e99c09a1",
                      "credentials":  {
                                          "microsoftOutlookOAuth2Api":  {
                                                                            "id":  "wSLPm1S7vuBelc25",
                                                                            "name":  "Microsoft Outlook account 3"
                                                                        }
                                      }
                  },
                  {
                      "parameters":  {
                                         "toRecipients":  "={{ $json.recepientEmail }}",
                                         "subject":  "={{ $json.emailSubject }}",
                                         "bodyContent":  "={{ $json.emailBody }}",
                                         "additionalFields":  {
                                                                  "attachments":  {
                                                                                      "attachments":  [
                                                                                                          {
                                                                                                              "binaryPropertyName":  "resume"
                                                                                                          }
                                                                                                      ]
                                                                                  }
                                                              }
                                     },
                      "type":  "n8n-nodes-base.microsoftOutlook",
                      "typeVersion":  2,
                      "position":  [
                                       -1440,
                                       -48
                                   ],
                      "id":  "f54afedf-0251-41ed-8380-9e5e99cd1541",
                      "name":  "Inbox dachevivo",
                      "webhookId":  "fe8a1e12-3fe8-469b-9279-5c98e99c09a1",
                      "credentials":  {
                                          "microsoftOutlookOAuth2Api":  {
                                                                            "id":  "nfaK9aEhGOnLLHC4",
                                                                            "name":  "Microsoft Outlook account"
                                                                        }
                                      }
                  },
                  {
                      "parameters":  {
                                         "toRecipients":  "={{ $json.recepientEmail }}",
                                         "subject":  "={{ $json.emailSubject }}",
                                         "bodyContent":  "={{ $json.emailBody }}",
                                         "additionalFields":  {
                                                                  "attachments":  {
                                                                                      "attachments":  [
                                                                                                          {
                                                                                                              "binaryPropertyName":  "resume"
                                                                                                          }
                                                                                                      ]
                                                                                  }
                                                              }
                                     },
                      "type":  "n8n-nodes-base.microsoftOutlook",
                      "typeVersion":  2,
                      "position":  [
                                       -1440,
                                       128
                                   ],
                      "id":  "0e5bbc94-877a-4d02-88d9-de7073145720",
                      "name":  "Inbox dachevivo2",
                      "webhookId":  "fe8a1e12-3fe8-469b-9279-5c98e99c09a1",
                      "credentials":  {
                                          "microsoftOutlookOAuth2Api":  {
                                                                            "id":  "nrD1wFbznQD78xNa",
                                                                            "name":  "Microsoft Outlook account 2"
                                                                        }
                                      }
                  },
                  {
                      "parameters":  {
                                         "toRecipients":  "={{ $json.recepientEmail }}",
                                         "subject":  "={{ $json.emailSubject }}",
                                         "bodyContent":  "={{ $json.emailBody }}",
                                         "additionalFields":  {
                                                                  "attachments":  {
                                                                                      "attachments":  [
                                                                                                          {
                                                                                                              "binaryPropertyName":  "resume"
                                                                                                          }
                                                                                                      ]
                                                                                  }
                                                              }
                                     },
                      "type":  "n8n-nodes-base.microsoftOutlook",
                      "typeVersion":  2,
                      "position":  [
                                       -1440,
                                       304
                                   ],
                      "id":  "a224810c-e24c-4fd6-9a20-df5c44d4e977",
                      "name":  "Inbox dachevivo3",
                      "webhookId":  "fe8a1e12-3fe8-469b-9279-5c98e99c09a1",
                      "credentials":  {
                                          "microsoftOutlookOAuth2Api":  {
                                                                            "id":  "wSLPm1S7vuBelc25",
                                                                            "name":  "Microsoft Outlook account 3"
                                                                        }
                                      }
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// Gmail MIME Builder - Constructs RFC 2822 compliant multipart MIME email\n// Input: $json.emailSubject, $json.emailBody, binary data 'resume'\n// Output: Base64url encoded MIME message ready for Gmail API\n\nconst items = $input.all();\nconst outputItems = [];\n\nfor (const item of items) {\n  try {\n    // Extract input data\n    const subject = item.json.emailSubject;\n    const bodyText = item.json.emailBody;\n    const recipientEmail = $('Outreach Input Processing').item.json.contact.email;\n   //const recipientEmail = 'dachevivo@gmail.com';\n    const senderEmail = 'dachevivo@gmail.com';\n    \n    // Get resume PDF binary data\n    const resumeBinary = item.binary.resume;\n    if (!resumeBinary) {\n      throw new Error('Resume binary data not found');\n    }\n    \n    // Convert binary data to base64\n    const resumeBase64 = resumeBinary.data;\n    const resumeFilename = item.json.resumeFilename || 'Resume.pdf';\n    \n    // Generate unique MIME boundaries\n    const boundaryMixed = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    const boundaryAlt = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    \n    // Convert plain text body (preserve newlines)\n    const plainTextBody = bodyText;\n    \n    // Convert HTML body (replace \\n\\n with <br><br>, \\n with <br>)\n    const htmlBody = '<div style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6;\">' +\n      bodyText.replace(/\\n\\n/g, '<br><br>').replace(/\\n/g, '<br>') +\n      '</div>';\n    \n    // Construct RFC 2822 compliant MIME message\n    const mimeMessage = [\n      `From: ${senderEmail}`,\n      `To: ${recipientEmail}`,\n      `Subject: ${subject}`,\n      `MIME-Version: 1.0`,\n      `Content-Type: multipart/mixed; boundary=\"${boundaryMixed}\"`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: multipart/alternative; boundary=\"${boundaryAlt}\"`,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/plain; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      plainTextBody,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/html; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      htmlBody,\n      ``,\n      `--${boundaryAlt}--`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: application/pdf; name=\"${resumeFilename}\"`,\n      `Content-Disposition: attachment; filename=\"${resumeFilename}\"`,\n      `Content-Transfer-Encoding: base64`,\n      ``,\n      resumeBase64,\n      ``,\n      `--${boundaryMixed}--`\n    ].join('\\r\\n');\n    \n    // Base64url encode the entire MIME message\n    const base64Message = Buffer.from(mimeMessage, 'utf-8').toString('base64');\n    const base64urlMessage = base64Message\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n      .replace(/=+$/, '');\n    \n    // Output for HTTP Request node\n    outputItems.push({\n      json: {\n        raw: base64urlMessage,\n        subject: subject,\n        recipient: recipientEmail,\n        mimeSize: mimeMessage.length\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n    \n  } catch (error) {\n    outputItems.push({\n      json: {\n        error: error.message,\n        subject: item.json.emailSubject || 'Unknown',\n        recipient: $('Outreach Input Processing').item.json.contact.email\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n  }\n}\n\nreturn outputItems;"
                                     },
                      "id":  "eca85ef6-1618-4afc-aaa9-afc2e7ff5d62",
                      "name":  "Gmail MIME Builder - Draft1",
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -1504,
                                       1664
                                   ]
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// Gmail MIME Builder - Constructs RFC 2822 compliant multipart MIME email\n// Input: $json.emailSubject, $json.emailBody, binary data 'resume'\n// Output: Base64url encoded MIME message ready for Gmail API\n\nconst items = $input.all();\nconst outputItems = [];\n\nfor (const item of items) {\n  try {\n    // Extract input data\n    const subject = item.json.emailSubject;\n    const bodyText = item.json.emailBody;\n    const recipientEmail = $('Outreach Input Processing').item.json.contact.email;\n    //const recipientEmail = 'dachevivo@gmail.com';\n    const senderEmail = 'dachevivo@gmail.com';\n    \n    // Get resume PDF binary data\n    const resumeBinary = item.binary.resume;\n    if (!resumeBinary) {\n      throw new Error('Resume binary data not found');\n    }\n    \n    // Convert binary data to base64\n    const resumeBase64 = resumeBinary.data;\n    const resumeFilename = item.json.resumeFilename || 'Resume.pdf';\n    \n    // Generate unique MIME boundaries\n    const boundaryMixed = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    const boundaryAlt = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    \n    // Convert plain text body (preserve newlines)\n    const plainTextBody = bodyText;\n    \n    // Convert HTML body (replace \\n\\n with <br><br>, \\n with <br>)\n    const htmlBody = '<div style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6;\">' +\n      bodyText.replace(/\\n\\n/g, '<br><br>').replace(/\\n/g, '<br>') +\n      '</div>';\n    \n    // Construct RFC 2822 compliant MIME message\n    const mimeMessage = [\n      `From: ${senderEmail}`,\n      `To: ${recipientEmail}`,\n      `Subject: ${subject}`,\n      `MIME-Version: 1.0`,\n      `Content-Type: multipart/mixed; boundary=\"${boundaryMixed}\"`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: multipart/alternative; boundary=\"${boundaryAlt}\"`,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/plain; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      plainTextBody,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/html; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      htmlBody,\n      ``,\n      `--${boundaryAlt}--`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: application/pdf; name=\"${resumeFilename}\"`,\n      `Content-Disposition: attachment; filename=\"${resumeFilename}\"`,\n      `Content-Transfer-Encoding: base64`,\n      ``,\n      resumeBase64,\n      ``,\n      `--${boundaryMixed}--`\n    ].join('\\r\\n');\n    \n    // Base64url encode the entire MIME message\n    const base64Message = Buffer.from(mimeMessage, 'utf-8').toString('base64');\n    const base64urlMessage = base64Message\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n      .replace(/=+$/, '');\n    \n    // Output for HTTP Request node\n    outputItems.push({\n      json: {\n        raw: base64urlMessage,\n        subject: subject,\n        recipient: recipientEmail,\n        mimeSize: mimeMessage.length\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n    \n  } catch (error) {\n    outputItems.push({\n      json: {\n        error: error.message,\n        subject: item.json.emailSubject || 'Unknown',\n        recipient: $('Outreach Input Processing').item.json.contact.email\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n  }\n}\n\nreturn outputItems;"
                                     },
                      "id":  "d3d2fa10-598e-420d-9053-db1c1db2ea9f",
                      "name":  "Gmail MIME Builder - Draft2",
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -1488,
                                       1824
                                   ]
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// Gmail MIME Builder - Constructs RFC 2822 compliant multipart MIME email\n// Input: $json.emailSubject, $json.emailBody, binary data 'resume'\n// Output: Base64url encoded MIME message ready for Gmail API\n\nconst items = $input.all();\nconst outputItems = [];\n\nfor (const item of items) {\n  try {\n    // Extract input data\n    const subject = item.json.emailSubject;\n    const bodyText = item.json.emailBody;\n    const recipientEmail = $('Outreach Input Processing').item.json.contact.email;\n    //const recipientEmail = 'dachevivo@gmail.com';\n    const senderEmail = 'dachevivo@gmail.com';\n    \n    // Get resume PDF binary data\n    const resumeBinary = item.binary.resume;\n    if (!resumeBinary) {\n      throw new Error('Resume binary data not found');\n    }\n    \n    // Convert binary data to base64\n    const resumeBase64 = resumeBinary.data;\n    const resumeFilename = item.json.resumeFilename || 'Resume.pdf';\n    \n    // Generate unique MIME boundaries\n    const boundaryMixed = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    const boundaryAlt = `----=_Part_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n    \n    // Convert plain text body (preserve newlines)\n    const plainTextBody = bodyText;\n    \n    // Convert HTML body (replace \\n\\n with <br><br>, \\n with <br>)\n    const htmlBody = '<div style=\"font-family: Arial, sans-serif; font-size: 14px; line-height: 1.6;\">' +\n      bodyText.replace(/\\n\\n/g, '<br><br>').replace(/\\n/g, '<br>') +\n      '</div>';\n    \n    // Construct RFC 2822 compliant MIME message\n    const mimeMessage = [\n      `From: ${senderEmail}`,\n      `To: ${recipientEmail}`,\n      `Subject: ${subject}`,\n      `MIME-Version: 1.0`,\n      `Content-Type: multipart/mixed; boundary=\"${boundaryMixed}\"`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: multipart/alternative; boundary=\"${boundaryAlt}\"`,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/plain; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      plainTextBody,\n      ``,\n      `--${boundaryAlt}`,\n      `Content-Type: text/html; charset=\"UTF-8\"`,\n      `Content-Transfer-Encoding: 7bit`,\n      ``,\n      htmlBody,\n      ``,\n      `--${boundaryAlt}--`,\n      ``,\n      `--${boundaryMixed}`,\n      `Content-Type: application/pdf; name=\"${resumeFilename}\"`,\n      `Content-Disposition: attachment; filename=\"${resumeFilename}\"`,\n      `Content-Transfer-Encoding: base64`,\n      ``,\n      resumeBase64,\n      ``,\n      `--${boundaryMixed}--`\n    ].join('\\r\\n');\n    \n    // Base64url encode the entire MIME message\n    const base64Message = Buffer.from(mimeMessage, 'utf-8').toString('base64');\n    const base64urlMessage = base64Message\n      .replace(/\\+/g, '-')\n      .replace(/\\//g, '_')\n      .replace(/=+$/, '');\n    \n    // Output for HTTP Request node\n    outputItems.push({\n      json: {\n        raw: base64urlMessage,\n        subject: subject,\n        recipient: recipientEmail,\n        mimeSize: mimeMessage.length\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n    \n  } catch (error) {\n    outputItems.push({\n      json: {\n        error: error.message,\n        subject: item.json.emailSubject || 'Unknown',\n        recipient: $('Outreach Input Processing').item.json.contact.email\n      },\n      pairedItem: { item: items.indexOf(item) }\n    });\n  }\n}\n\nreturn outputItems;"
                                     },
                      "id":  "af5943ac-9574-45a4-9e89-f9155064060c",
                      "name":  "Gmail MIME Builder - Draft3",
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -1488,
                                       2016
                                   ]
                  },
                  {
                      "parameters":  {
                                         "method":  "POST",
                                         "url":  "https://gmail.googleapis.com/gmail/v1/users/me/messages/send",
                                         "authentication":  "predefinedCredentialType",
                                         "nodeCredentialType":  "googleOAuth2Api",
                                         "sendHeaders":  true,
                                         "headerParameters":  {
                                                                  "parameters":  [
                                                                                     {
                                                                                         "name":  "Content-Type",
                                                                                         "value":  "application/json"
                                                                                     }
                                                                                 ]
                                                              }, 
                                         "sendBody":  true,
                                         "specifyBody":  "json",
                                         "jsonBody":  "={{ { \"raw\": $json.raw } }}",
                                         "options":  {

                                                     }
                                     },
                      "id":  "83490d5c-551f-4705-9aa9-71e2884f1fed",
                      "name":  "Gmail - ivodachevd - Draft",
                      "type":  "n8n-nodes-base.httpRequest",
                      "typeVersion":  4.2,
                      "position":  [
                                       -1104,
                                       2016
                                   ],
                      "credentials":  {
                                          "googleOAuth2Api":  {
                                                                  "id":  "w8nTWzWPswftVYqH",
                                                                  "name":  "Google account"
                                                              }
                                      }
                  },
                  {
                      "parameters":  {
                                         "method":  "POST",
                                         "url":  "https://gmail.googleapis.com/gmail/v1/users/me/messages/send",
                                         "authentication":  "predefinedCredentialType",
                                         "nodeCredentialType":  "googleOAuth2Api",
                                         "sendHeaders":  true,
                                         "headerParameters":  {
                                                                  "parameters":  [
                                                                                     {
                                                                                         "name":  "Content-Type",
                                                                                         "value":  "application/json"
                                                                                     }
                                                                                 ]
                                                              }, 
                                         "sendBody":  true,
                                         "specifyBody":  "json",
                                         "jsonBody":  "={{ { \"raw\": $json.raw } }}",
                                         "options":  {

                                                     }
                                     },
                      "id":  "2e363c08-82d6-435b-bf0a-f7c90ca2706f",
                      "name":  "Gmail - dachevivo - Draft",
                      "type":  "n8n-nodes-base.httpRequest",
                      "typeVersion":  4.2,
                      "position":  [
                                       -1152,
                                       1632
                                   ],
                      "credentials":  {
                                          "googleOAuth2Api":  {
                                                                  "id":  "w8nTWzWPswftVYqH",
                                                                  "name":  "Google account"
                                                              }
                                      }
                  },
                  {
                      "parameters":  {
                                         "method":  "POST",
                                         "url":  "https://gmail.googleapis.com/gmail/v1/users/me/messages/send",
                                         "authentication":  "predefinedCredentialType",
                                         "nodeCredentialType":  "googleOAuth2Api",
                                         "sendHeaders":  true,
                                         "headerParameters":  {
                                                                  "parameters":  [
                                                                                     {
                                                                                         "name":  "Content-Type",
                                                                                         "value":  "application/json"
                                                                                     }
                                                                                 ]
                                                              }, 
                                         "sendBody":  true,
                                         "specifyBody":  "json",
                                         "jsonBody":  "={{ { \"raw\": $json.raw } }}",
                                         "options":  {

                                                     }
                                     },
                      "id":  "0a6ac39a-9760-47d9-ac4c-0d57bd941a6f",
                      "name":  "Gmail - ivoddachev - Draft",
                      "type":  "n8n-nodes-base.httpRequest",
                      "typeVersion":  4.2,
                      "position":  [
                                       -1072,
                                       1808
                                   ],
                      "credentials":  {
                                          "googleOAuth2Api":  {
                                                                  "id":  "w8nTWzWPswftVYqH",
                                                                  "name":  "Google account"
                                                              }
                                      }
                  },
                  {
                      "parameters":  {
                                         "jsCode":  "// ============================================\\n// TEST MODE BOOLEAN CONVERSION FIX\\n// ============================================\\n// Purpose: Ensure testMode flag is boolean before Test Mode Router\\n// Version: 1.0\\n// ============================================\\n\nconst items = $input.all();\\n\nconsole.log('üîç TEST MODE BOOLEAN CONVERSION FIX (v1.0)');\\nconsole.log('   Total items:', items.length);\\n\nreturn items.map((item, index) => {\\n  const testMode = item.json.testMode;\\n  const testModeType = typeof testMode;\\n  \\n  // Log original value for debugging\\n  console.log(`   Item ${index}:`);\\n  console.log(`     Original testMode value: ${testMode}`);\\n  console.log(`     Original testMode type: ${testModeType}`);\\n  \\n  // Force boolean conversion\\n  // Handles: true, \"TRUE\", \"true\", 1, \"1\"\\n  const testModeBoolean = testMode === true || \n                          testMode === 'TRUE' || \n                          testMode === 'true' || \n                          testMode === 1 || \n                          testMode === '1';\\n  \\n  console.log(`     Converted testMode: ${testModeBoolean} (boolean)`);\\n  console.log(`     Will route to: ${testModeBoolean ? 'Output 0 (Draft Creation)' : 'Output 1 (Send Email)'}`);\\n  \\n  return {\\n    json: {\\n      ...item.json,\n      testMode: testModeBoolean,  // ‚úÖ Guaranteed boolean\\n      \\n      // Add debug metadata\\n      testModeDebug: {\\n        originalValue: testMode,\n        originalType: testModeType,\n        convertedValue: testModeBoolean,\n        convertedType: 'boolean',\n        conversionApplied: true,\n        fixVersion: 'v1.0-BOOLEAN-CONVERSION'\\n      }
    },\n    binary: item.binary,\n    pairedItem: item.pairedItem || { item: index }
  };
});"
                                     },
                      "type":  "n8n-nodes-base.code",
                      "typeVersion":  2,
                      "position":  [
                                       -208,
                                       -528
                                   ],
                      "id":  "36b755f7-624e-4ad0-a640-39536996e325",
                      "name":  "Test Node Boolean Conversion Fix"
                  }
              ],
    "connections":  {
                        "Execute Workflow Trigger - From Orchestrator":  {
                                                                             "main":  [
                                                                                          [{"node":  "Outreach Input Processing", "type":  "main", "index":  0}]
                                                                                      ]
                                                                         },
                        "Outreach Input Processing":  {
                                                          "main":  [
                                                                       [{"node":  "If - Duplicate or not", "type":  "main", "index":  0}]
                                                                   ]
                                                      },
                        "AI Email Generation":  {
                                                    "main":  [
                                                                 [{"node":  "Create Resume Document", "type":  "main", "index":  0}]
                                                             ]
                                                },
                        "If - Duplicate or not":  {
                                                      "main":  [
                                                                   [{"node":  "Merge Duplicate and Email", "type":  "main", "index":  0}],
                                                                   [{"node":  "AI Email Generation", "type":  "main", "index":  0}]
                                                               ]
                                                  },
                        "Merge Duplicate and Email":  {
                                                          "main":  [
                                                                       [{"node":  "Status Update", "type":  "main", "index":  0}]
                                                                   ]
                                                      },
                        "Create Resume Document":  {
                                                       "main":  [
                                                                    [{"node":  "Update a document", "type":  "main", "index":  0}]
                                                                ]
                                                   },
                        "Update a document":  {
                                                  "main":  [
                                                               [{"node":  "Export Resume as PDF", "type":  "main", "index":  0}]
                                                           ]
                                              },
                        "Export Resume as PDF":  {
                                                     "main":  [
                                                                  [{"node":  "Resume Filename Customizer", "type":  "main", "index":  0}]
                                                              ]
                                                 },
                        "Resume Filename Customizer":  {
                                                           "main":  [
                                                                        [{"node":  "Daily Email Volume Control", "type":  "main", "index":  0}]
                                                                    ]
                                                       },
                        "Dynamic Priority-Based Account Selector":  {
                                                                        "main":  [
                                                                                     [{"node":  "Test Mode Router", "type":  "main", "index":  0}, {"node":  "Test Node Boolean Conversion Fix", "type":  "main", "index":  0}]
                                                                                 ]
                                                                    },
                        "Aggregate Email Metrics":  {
                                                        "main":  [
                                                                     [{"node":  "Merge Duplicate and Email", "type":  "main", "index":  1}, {"node":  "Email Tracking Dashboard", "type":  "main", "index":  0}]
                                                                 ]
                                                    },
                        "Daily Email Volume Control":  {
                                                           "main":  [
                                                                        [{"node":  "Read Counter", "type":  "main", "index":  0}]
                                                                    ]
                                                       },
                        "Read Counter":  {
                                             "main":  [
                                                          [{"node":  "Filter to Row 2 (Counter Only)", "type":  "main", "index":  0}]
                                                      ]
                                         },
                        "Filter to Row 2 (Counter Only)":  {
                                                               "main":  [
                                                                            [{"node":  "Read Email-Account-Config", "type":  "main", "index":  0}]
                                                                        ]
                                                           },
                        "Gmail - ivoddachev":  {
                                                   "main":  [
                                                                [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                            ]
                                               },
                        "Gmail - dachevivo":  {
                                                  "main":  [
                                                               [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                           ]
                                              },
                        "6-Account Email Router":  {
                                                       "main":  [
                                                                    [{"node":  "Gmail MIME Builder", "type":  "main", "index":  0}, {"node":  "Gmail MIME Builder1", "type":  "main", "index":  0}, {"node":  "Gmail MIME Builder2", "type":  "main", "index":  0}],
                                                                    [{"node":  "Inbox dachevivo", "type":  "main", "index":  0}],
                                                                    [{"node":  "Inbox dachevivo2", "type":  "main", "index":  0}],
                                                                    [{"node":  "Inbox dachevivo3", "type":  "main", "index":  0}],
                                                                    [],
                                                                    [],
                                                                    []
                                                                ]
                                                   },
                        "Filter Active Accounts":  {
                                                       "main":  [
                                                                    [{"node":  "Dynamic Priority-Based Account Selector", "type":  "main", "index":  0}]
                                                                ]
                                                   },
                        "Read Email-Account-Config":  {
                                                          "main":  [
                                                                       [{"node":  "Filter Active Accounts", "type":  "main", "index":  0}]
                                                                   ]
                                                      },
                        "Gmail MIME Builder":  {
                                                   "main":  [
                                                                [{"node":  "Gmail - dachevivo", "type":  "main", "index":  0}]
                                                            ]
                                               },
                        "Gmail MIME Builder1":  {
                                                    "main":  [
                                                                 [{"node":  "Gmail - ivoddachev", "type":  "main", "index":  0}]
                                                             ]
                                                },
                        "Gmail MIME Builder2":  {
                                                    "main":  [
                                                                 [{"node":  "Gmail - ivodachevd", "type":  "main", "index":  0}]
                                                             ]
                                                },
                        "Inbox dachevivo":  {
                                                "main":  [
                                                             [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                         ]
                                            },
                        "Inbox dachevivo2":  {
                                                 "main":  [
                                                              [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                          ]
                                             },
                        "Inbox dachevivo3":  {
                                                 "main":  [
                                                              [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                          ]
                                             },
                        "Gmail MIME Builder - Draft1":  {
                                                            "main":  [
                                                                         [{"node":  "Gmail - dachevivo - Draft", "type":  "main", "index":  0}]
                                                                     ]
                                                        },
                        "Gmail MIME Builder - Draft2":  {
                                                            "main":  [
                                                                         [{"node":  "Gmail - ivoddachev - Draft", "type":  "main", "index":  0}]
                                                                     ]
                                                        },
                        "Gmail MIME Builder - Draft3":  {
                                                            "main":  [
                                                                         [{"node":  "Gmail - ivodachevd - Draft", "type":  "main", "index":  0}]
                                                                     ]
                                                        },
                        "Test Mode Router":  {
                                                 "main":  [
                                                              [{"node":  "Draft Creation Router", "type":  "main", "index":  0}],
                                                              [{"node":  "6-Account Email Router", "type":  "main", "index":  0}]
                                                          ]
                                             },
                        "Draft Creation Router":  {
                                                      "main":  [
                                                                   [{"node":  "Gmail MIME Builder - Draft1", "type":  "main", "index":  0}],
                                                                   [{"node":  "Gmail MIME Builder - Draft2", "type":  "main", "index":  0}],
                                                                   [{"node":  "Gmail MIME Builder - Draft3", "type":  "main", "index":  0}],
                                                                   [{"node":  "Draft dachevivo", "type":  "main", "index":  0}],
                                                                   [{"node":  "draft dachevivo2", "type":  "main", "index":  0}],
                                                                   [{"node":  "Draft dachevivo3", "type":  "main", "index":  0}]
                                                               ]
                                                  },
                        "Draft dachevivo":  {
                                                "main":  [
                                                             [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                         ]
                                            },
                        "draft dachevivo2":  {
                                                 "main":  [
                                                              [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                          ]
                                             },
                        "Draft dachevivo3":  {
                                                 "main":  [
                                                              [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                          ]
                                             },
                        "Gmail - dachevivo - Draft":  {
                                                          "main":  [
                                                                       [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                                   ]
                                                      },
                        "Gmail - ivoddachev - Draft":  {
                                                           "main":  [
                                                                        [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                                    ]
                                                       },
                        "Gmail - ivodachevd - Draft":  {
                                                           "main":  [
                                                                        [{"node":  "Aggregate Email Metrics", "type":  "main", "index":  0}]
                                                                    ]
                                                       },
                        "Test Node Boolean Conversion Fix":  {
                                                                 "main":  [
                                                                              [{"node":  "Update Counter", "type":  "main", "index":  0}]
                                                                          ]
                                                              }
                    },
    "settings":  {
                     "callerPolicy":  "workflowsFromSameOwner",
                     "availableInMCP":  false,
                     "timezone":  "America/Los_Angeles",
                     "executionOrder":  "v0"
                 },
    "staticData":  null,
    "meta":  {
                 "templateCredsSetupCompleted":  true
             },
    "pinData":  {

                },
    "versionId":  "46fc0bd9-2945-4dc5-9cd4-37ad6535dc73",
    "versionCounter":  217,
    "triggerCount":  1,
    "shared":  [
                   {
                       "updatedAt":  "2025-11-12T02:04:21.455Z",
                       "createdAt":  "2025-11-12T02:04:21.455Z",
                       "role":  "workflow:owner",
                       "workflowId":  "WUe4y8iYEXNAB6dq",
                       "projectId":  "1nA39eVus9AACl1f",
                       "project":  {
                                       "updatedAt":  "2025-08-23T16:23:23.630Z",
                                       "createdAt":  "2025-08-23T16:02:53.713Z",
                                       "id":  "1nA39eVus9AACl1f",
                                       "name":  "Ivo Dachev <dachevivo@gmail.com>",
                                       "type":  "personal",
                                       "icon":  null,
                                       "description":  null,
                                       "projectRelations":  [
                                                                {
                                                                    "updatedAt":  "2025-08-23T16:02:53.713Z",
                                                                    "createdAt":  "2025-08-23T16:02:53.713Z",
                                                                    "userId":  "0aa3f394-4258-4544-8488-960d18baca6d",
                                                                    "projectId":  "1nA39eVus9AACl1f",
                                                                    "user":  {
                                                                                 "updatedAt":  "2025-11-23T05:48:32.000Z",
                                                                                 "createdAt":  "2025-08-23T16:02:52.851Z",
                                                                                 "id":  "0aa3f394-4258-4544-8488-960d18baca6d",
                                                                                 "email":  "dachevivo@gmail.com",
                                                                                 "firstName":  "Ivo",
                                                                                 "lastName":  "Dachev",
                                                                                 "personalizationAnswers":  {
                                                                                                                "version":  "v4",
                                                                                                                "personalization_survey_submitted_at":  "2025-08-23T16:24:15.627Z",
                                                                                                                "personalization_survey_n8n_version":  "1.107.4",
                                                                                                                "automationGoalDevops":  [
                                                                                                                                             "cloud-infrastructure-orchestration"
                                                                                                          ],
                                                                                                                "companySize":  "<20",
                                                                                                                "companyType":  "digital-agency",
                                                                                                                "role":  "it",
                                                                                                                "reportedSource":  "youtube"
                                                                                                            },
                                                                                                                "settings":  {
                                                                                                                                 "userActivated":  true,
                                                                                                                                 "easyAIWorkflowOnboarded":  true,
                                                                                                                                 "dismissedCallouts":  {
                                                                                                                                                           "preBuiltAgentsCalloutHttpRequest":  true,
                                                                                                                                                           "preBuiltAgentsCallout":  true,
                                                                                                                                                           "preBuiltAgentsCalloutGoogleSheets":  true,
                                                                                                                                                           "preBuiltAgentsModalCallout":  true
                                                                                                                        },
                                                                                                                                 "firstSuccessfulWorkflowId":  "HuZ10YOgOiTlYGrM",
                                                                                                                                 "userActivatedAt":  1757356687300,
                                                                                                                                 "npsSurvey":  {
                                                                                                                                                   "responded":  true,
                                                                                                                                                   "lastShownAt":  1757703111289
                                                                                                                                               }
                                                                                                                             }
                                                                                                                "disabled":  false,
                                                                                                                "mfaEnabled":  false,
                                                                                                                "lastActiveAt":  "2025-11-22",
                                                                                                                "isPending":  false
                                                                                                            }
                                                                }
                                                            ]
                                   }
                   }
               ],
    "tags":  [
                 {
                     "updatedAt":  "2025-09-10T16:23:08.235Z",
                     "createdAt":  "2025-09-10T16:23:08.235Z",
                     "id":  "FrnybmIzoJd732QS",
                     "name":  "Augment Code"
                 },
                 {
                     "updatedAt":  "2025-09-13T21:08:18.122Z",
                     "createdAt":  "2025-09-13T21:08:18.122Z",
                     "id":  "H8bAHR6C77zCCEmw",
                     "name":  "sub-flow"
                 }
             ]
}